<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:p="http://primefaces.org/ui"
	xmlns:webred="http://java.sun.com/jsf/composite/webred" xmlns:webredcs="http://java.sun.com/jsf/composite/webredcs">
<ui:composition template="/jsp/protected/layout/layout.xhtml">

	<ui:define name="content">

		<p:ajaxStatus onstart="PF('statusDialog').show();" onsuccess="PF('statusDialog').hide();" />

		<p:dialog modal="true" widgetVar="statusDialog" header="Caricamento" draggable="false" closable="false" resizable="false">
			<p:graphicImage value="/images/loadingbar.gif" />
		</p:dialog>
		
		<f:metadata>
		    <f:viewParam name="currentLocation" value="#{nuovaSchedaWizard.indietroButtonTesto}" />
		</f:metadata>
		
		<h:form id="goBackForm">
			<p:commandLink id="goBackCommandLink" ajax="false" actionListener="#{nuovaSchedaWizard.goBack}" value="Torna a #{nuovaSchedaWizard.indietroButtonTesto}">
		    </p:commandLink>
		</h:form>
		<p:separator/>

		<h:form id="form">
		  <p:outputPanel style="width:100%">
				 <h:outputText rendered="#{nuovaSchedaWizard.scheda.identificativo!=null}" 
				               value="Identificativo num.: #{nuovaSchedaWizard.scheda.identificativo}" style="font-weight:bold;" />
				
				<div class="last">
					<h:panelGrid columns="2" columnClasses="label, value" styleClass="grid">
						<h:outputText value="Ufficio:" style="font-weight:bold;" />
						<h:outputText value="#{preselPuntoContatto.puntoContatto.ufficio.nome}" />
						<h:outputText value="Luogo:" style="font-weight:bold;" />
						<h:outputText value="#{preselPuntoContatto.puntoContatto.nomePContatto}" rendered="#{preselPuntoContatto.puntoContatto.nomePContatto!=null}" />
						<h:outputText value="nessuna selezione" style="color:red;" rendered="#{preselPuntoContatto.puntoContatto.nomePContatto==null}" />
					</h:panelGrid>
				</div>
			</p:outputPanel>
			<p:wizard id="wizard" flowListener="#{nuovaSchedaWizard.onFlowProcess}" 
			          backLabel="Indietro" nextLabel="Avanti e Registra" showStepStatus="true" widgetVar="wizardSS">

				<p:tab id="accesso" title="Accesso" >

					<p:panel id="anagrafica_panel" header="Modalità di accesso" toggleable="true" toggleSpeed="500">
						<h:panelGrid columns="6" columnClasses="label, value" styleClass="grid">
							<h:outputText value="Ufficio:" style="font-weight:bold;" />
							<h:outputText value="#{nuovaSchedaWizard.accesso.puntoContatto.ufficio.nome}" />

							<h:outputText value="Luogo:" style="font-weight:bold;" />
							<h:outputText value="#{nuovaSchedaWizard.accesso.puntoContatto.nomePContatto}" />

							<h:outputText value="Ente di riferimento:" style="font-weight:bold;" />
							<h:outputText value="#{nuovaSchedaWizard.accesso.puntoContatto.organizzazione.nome}" />

						</h:panelGrid>
						<p:spacer height="10px" />
						<h:panelGrid columns="4" columnClasses="label, value" styleClass="grid">
							<h:outputText value="Data di accesso *" for="data_accesso" />
							<webred:pnlData  dataValue="#{nuovaSchedaWizard.accesso.dataAccesso}" dataPattern="dd/MM/yyyy" dataPatternLabel="(gg/mm/aaaa)" 
											 dataReq="true" dataReqMes="'Data di accesso' è un campo obbligatorio"  />

							<h:outputText value="Operatore *" for="operatore" />
							<p:selectOneMenu label="Operatore" id="operatore" required="true" value="#{nuovaSchedaWizard.accesso.operatore}" effect="fold" editable="false">
								<f:selectItem noSelectionOption="true" itemLabel="- seleziona -"/>
								<f:selectItems value="#{nuovaSchedaWizard.operatori}" />
							</p:selectOneMenu>

							<h:outputText value="Descrizione scheda " for="descrizione_scheda" />
							<p:inputText label="Descrizione scheda" id="descrizione_scheda" value="#{nuovaSchedaWizard.accesso.descrizione}" />

							<h:outputText value="Interlocutore *" for="interlocutore" />
							<p:selectOneMenu label="Interlocutore" id="interlocutore" required="true" value="#{nuovaSchedaWizard.accesso.interlocutore}" effect="fold" editable="false">
								<f:selectItem itemLabel="- seleziona -" itemValue="" />
								<f:selectItems value="#{nuovaSchedaWizard.interlocutori}" />
							</p:selectOneMenu>

							<h:outputText value="Motivo Accesso *" for="motivo_accesso" />
							<p:selectOneMenu label="Motivo Accesso" id="motivo_accesso" required="true" value="#{nuovaSchedaWizard.accesso.motivo}" effect="fold" editable="false">
								<f:selectItem itemLabel="- seleziona -" itemValue="" />
								<f:selectItems value="#{nuovaSchedaWizard.accessi}" />
							</p:selectOneMenu>

							<h:outputText value="Specificare " for="specificare_motivo" />
							<p:inputText label="Specificare" id="specificare_motivo" value="#{nuovaSchedaWizard.accesso.motivoDesc}" />

							<h:outputText value="Modalità di accesso *" for="modalita_accesso" />
							<p:selectOneMenu label="Modalità di accesso" id="modalita_accesso" required="true" value="#{nuovaSchedaWizard.accesso.modalitaAccesso}" effect="fold" editable="false">
								<f:selectItem itemLabel="- seleziona -" itemValue="" />
								<f:selectItems value="#{nuovaSchedaWizard.modalita}" />
							</p:selectOneMenu>

						</h:panelGrid>

						<p:spacer height="10px" />
						<p:separator />
						<webred:pnlRequiredSalva salvaAction="#{nuovaSchedaWizard.salvaTabAccesso()}" />
					</p:panel>
				</p:tab>

				<p:tab id="segnalante" title="Interlocutore">
					
					<p:panel id="pnlSearch" header="Ricerca Anagrafica Segnalante" toggleable="true" toggleSpeed="500">
						<h:panelGrid columns="1">
							<h:outputText value="Ricerca in anagrafe popolazione" styleClass="bold"/>	
						</h:panelGrid>
						<h:panelGrid styleClass="span-20" columns="2" columnClasses="span-2, span-10">
							<h:outputLabel value="Cognome e nome" />
							<webredcs:pnlUserSearch id="wbrdUserSearch" styleClass="myAutoComplete" userManBean="#{nuovaSchedaWizard.userSearchBean}" 
									componentsToUpdate="@widgetVar(widgetPnlSegnalante)"/>
						</h:panelGrid>
					</p:panel>
					<p:spacer height="20"/>
					
					<p:panel id="pnlSegnalante" header="Segnalante" toggleable="true" toggleSpeed="500" widgetVar="widgetPnlSegnalante" >

						<h:panelGrid columns="4" columnClasses="label, value" styleClass="grid">
							<h:outputText value="Cognome " for="cognome_segnalante" />
							<p:inputText label="Cognome" id="cognome_segnalante" style="text-transform: uppercase" value="#{nuovaSchedaWizard.segnalante.cognome}" />

							<h:outputText value="Nome " for="nome_segnalante" />
							<p:inputText label="Nome" id="nome_segnalante" style="text-transform: uppercase" value="#{nuovaSchedaWizard.segnalante.nome}" />
							
							<h:outputText value="Data di nascita " for="data_nascita_segnalante" />
							<webred:pnlData id="data_nascita_segnalante" dataValue="#{nuovaSchedaWizard.segnalante.dataNascita}" dataPattern="dd/MM/yyyy" dataPatternLabel="(gg/mm/aaaa)" yearRange="c-100:c+0" />
										    
							<h:outputText value="Luogo di nascita " for="citta_nascita_segnalante" />
							<h:panelGrid colums="1">
								<webred:pnlComuneNazione comuneNazioneManBean="#{nuovaSchedaWizard.segnalante.comuneNazioneNascitaMan}" extraLabelRequired="false" />
							</h:panelGrid>
							
							<h:outputText value="Stato civile " for="stato_civile_segnalante" />
							<p:selectOneMenu label="Stato civile" id="stato_civile_segnalante" value="#{nuovaSchedaWizard.segnalante.codStatoCivile}" effect="fold" editable="false">
								<f:selectItem itemLabel="- seleziona -" itemValue="" />
								<f:selectItems value="#{nuovaSchedaWizard.statiCiviliSelectItem}" />
							</p:selectOneMenu>
							
							<h:outputText value="Sesso " for="sesso_segnalato" />
							<webred:pnlSesso value="#{nuovaSchedaWizard.segnalante.datiSesso}" />
						</h:panelGrid>
							
							<p:spacer height="10px" />
							<p:separator />
							<p:spacer height="10px" />
						
						<h:panelGrid columns="4" columnClasses="label, value" styleClass="grid">	
							<h:outputText value="Ente/Servizio " for="ente_segnalante" />
							<p:inputText label="Ente/Servizio" id="ente_segnalante" value="#{nuovaSchedaWizard.segnalante.ente}" />

							<h:outputText value="Ruolo " for="ruolo_segnalante" />
							<p:inputText label="Ruolo" id="ruolo_segnalante" value="#{nuovaSchedaWizard.segnalante.ruolo}" />

							<h:outputText value="Relazione " for="relazione_segnalante" />
							<p:selectOneMenu label="Relazione" id="relazione_segnalante" filter="true" filterMatchMode="contains"
							                 value="#{nuovaSchedaWizard.segnalante.codRelazione}" >
								<f:selectItem noSelectionOption="true" itemLabel="- seleziona -"/>
								<f:selectItems value="#{nuovaSchedaWizard.relazioni}" />
							</p:selectOneMenu>

						</h:panelGrid>

						<p:spacer height="10px" />
						<p:separator />
						<p:spacer height="10px" />

						<h:panelGrid columns="4" columnClasses="label, value" styleClass="grid">
							<h:outputText value="Telefono " for="tel_segnalante" />
							<p:inputText label="Telefono" id="tel_segnalante" value="#{nuovaSchedaWizard.segnalante.telefono}">
								<f:convertNumber integerOnly="true" />
							</p:inputText>

							<h:outputText value="Cellulare " for="cel_segnalante" />
							<p:inputText label="Cellulare" id="cel_segnalante" value="#{nuovaSchedaWizard.segnalante.cellulare}">
								<f:convertNumber integerOnly="true" />
							</p:inputText>

							<h:outputText value="Email " for="email_segnalante" />
							<p:inputText label="Email" id="email_segnalante" value="#{nuovaSchedaWizard.segnalante.email}" />

						</h:panelGrid>

						<p:spacer height="10px" />
						<p:separator />
						<p:spacer height="10px" />

						<h:panelGrid columns="4" columnClasses="label, value" styleClass="grid">
							<h:outputText value="Indirizzo " for="indirizzo_segnalante" />
							<p:inputText label="Indirizzo" style="text-transform: uppercase" id="indirizzo_segnalante" value="#{nuovaSchedaWizard.segnalante.indirizzo}" />

							<h:outputText value="Comune " for="comune_segnalante" />
							<webred:pnlComune id="comune_segnalante" comuneManBean="#{nuovaSchedaWizard.segnalante}" value="#{nuovaSchedaWizard.segnalante.comune}" />

						</h:panelGrid>

						<p:spacer height="10px" />
						<p:separator />
						<p:spacer height="10px" />

						<h:panelGrid columns="2" columnClasses="label, value" styleClass="grid">
							<h:outputText value="Inviato da " for="inviante_segnalante" />
							<p:selectOneMenu label="Inviato da" id="inviante_segnalante" value="#{nuovaSchedaWizard.segnalante.inviante}" effect="fold" editable="false">
								<f:selectItem itemLabel="- seleziona -" itemValue="" />
								<f:selectItems value="#{nuovaSchedaWizard.inviatiDa}" />
							</p:selectOneMenu>
						</h:panelGrid>
						<p:separator />
						<webred:pnlRequiredSalva salvaAction="#{nuovaSchedaWizard.salvaTabSegnalante()}"  
						 						 renderRecupero="#{nuovaSchedaWizard.abilitaLoadPrecedente}"
						                         recuperoLastAction="#{nuovaSchedaWizard.valorizzaSegnalanteDaUltima()}" 
						                         panelToUpdate="pnlSegnalante"/>
					</p:panel>
				</p:tab>

				<p:tab id="segnalato" title="Utente">
					<p:panel id="pnlSegnalato" header="Utente" toggleable="true" toggleSpeed="500">

						<p:fieldset legend="Dati Anagrafici">
							<h:panelGrid columns="4" columnClasses="label, value" width="100%">
								<h:outputText value="Cognome *" for="cognome_segnalato" />
								<p:inputText disabled="#{nuovaSchedaWizard.segnalato.anagrafica.disableAnagrafica and nuovaSchedaWizard.segnalato.anagrafica.cognome!=null}" label="Cognome" id="cognome_segnalato" style="text-transform: uppercase"
									value="#{nuovaSchedaWizard.segnalato.anagrafica.cognome}" />

								<h:outputText value="Nome *" for="nome_segnalato" />
								<p:inputText disabled="#{nuovaSchedaWizard.segnalato.anagrafica.disableAnagrafica and nuovaSchedaWizard.segnalato.anagrafica.nome!=null}" label="Nome" id="nome_segnalato" style="text-transform: uppercase"
									value="#{nuovaSchedaWizard.segnalato.anagrafica.nome}" />

								<h:outputText value="Data di nascita *" for="data_nascita_segnalato" />
								<webred:pnlData id="data_nascita_segnalato" disabled="#{nuovaSchedaWizard.segnalato.anagrafica.disableAnagrafica and nuovaSchedaWizard.currentDate!=null}"
												dataValue="#{nuovaSchedaWizard.segnalato.anagrafica.dataNascita}" dataPattern="dd/MM/yyyy" dataPatternLabel="(gg/mm/aaaa)" 
											    yearRange="c-100:c+0"   />
								
								<h:outputText value="Luogo di nascita *" for="citta_nascita_segnalato" />
								<h:panelGrid colums="1">
									<h:panelGroup rendered="#{nuovaSchedaWizard.segnalato.anagrafica.comNascNonValido}">
										<h:outputText value="Luogo di nascita non riconosciuto " style="color:red; font-size:9px" />
										<h:outputText value="#{nuovaSchedaWizard.segnalato.anagrafica.comuneOld}" style="font-size:9px" />
									</h:panelGroup>
									<webred:pnlComuneNazione comuneNazioneManBean="#{nuovaSchedaWizard.segnalato.anagrafica.comuneNazioneNascitaMan}"
										disabled="#{nuovaSchedaWizard.segnalato.anagrafica.disableAnagrafica  and (!nuovaSchedaWizard.segnalato.anagrafica.comNascNonValido)}" 
										extraLabelRequired="true"/>

								</h:panelGrid>

								<h:outputText value="Codice fiscale *" for="codice_fiscale_segnalato" />
								<p:inputText disabled="#{nuovaSchedaWizard.segnalato.anagrafica.disableAnagrafica and nuovaSchedaWizard.segnalato.anagrafica.codiceFiscale!=null}" 
								label="Codice fiscale" id="codice_fiscale_segnalato" style="text-transform: uppercase" 
									value="#{nuovaSchedaWizard.segnalato.anagrafica.codiceFiscale}" >
									<p:ajax event="change" listener="#{nuovaSchedaWizard.onChangeCodiceFiscale}" update="pnlSegnalato"/>
								</p:inputText>

								<h:outputText value="Sesso *" for="sesso_segnalato" />
								<webred:pnlSesso value="#{nuovaSchedaWizard.segnalato.anagrafica.datiSesso}" disabled="#{nuovaSchedaWizard.segnalato.anagrafica.disableAnagrafica}" />	
									
								<h:outputText value="Stato civile *" for="stato_civile_segnalato" />
								<p:selectOneMenu label="Stato civile" id="stato_civile_segnalato" value="#{nuovaSchedaWizard.segnalato.anagrafica.statoCivile}" effect="fold" editable="false">
									<f:selectItem itemLabel="- seleziona -" itemValue="" />
									<f:selectItems value="#{nuovaSchedaWizard.statiCivili}" />
								</p:selectOneMenu>

								<h:outputText value="Cittadinanza *" for="cittadinanza_segnalato" />
								
								<p:selectOneMenu label="Cittadinanza" id="cittadinanza_segnalato" value="#{nuovaSchedaWizard.segnalato.anagrafica.cittadinanza}" effect="fold" editable="false" filter="true"
									filterMatchMode="startsWith">
									<f:selectItem itemLabel="- seleziona -" itemValue="" />
									<f:selectItems value="#{nuovaSchedaWizard.cittadinanze}" />
										<p:ajax event="change" immediate="true" update="pnlStranieriFieldset cittadinanza_acquisita_segnalato" />
								</p:selectOneMenu>
								
								<h:outputText value="Acquisita" for="cittadinanza_acquisita_segnalato" />
								<p:selectOneMenu id="cittadinanza_acquisita_segnalato" value="#{nuovaSchedaWizard.segnalato.anagrafica.cittadinanzaAcq}" 
								                 style="width:200px" effect="fold" editable="false" disabled="#{nuovaSchedaWizard.segnalato.anagrafica.cittadinanza ne 'ITALIANA'}">
									<f:selectItem itemLabel="- seleziona -" itemValue="" />
									<f:selectItems value="#{nuovaSchedaWizard.cittadinanzeAcquisite}" />
								</p:selectOneMenu>

								<h:outputText value="Seconda Cittadinanza" for="cittadinanza2_segnalato" />
								<p:selectOneMenu id="cittadinanza2_segnalato" value="#{nuovaSchedaWizard.segnalato.anagrafica.cittadinanza2}" effect="fold" editable="false" filter="true" filterMatchMode="startsWith">
									<f:selectItem itemLabel="- seleziona -" itemValue="" />
									<f:selectItems value="#{nuovaSchedaWizard.cittadinanze}" />
									<p:ajax event="change" immediate="true" update="pnlStranieriFieldset" />
								</p:selectOneMenu>

							</h:panelGrid>
							
						</p:fieldset>
						<p:spacer height="10px" />

						<p:outputPanel id="pnlStranieriFieldset" rendered="#{nuovaSchedaWizard.visPanelStranieri}">
							<p:fieldset legend="Presenza in Italia (per persone di origine straniera)" toggleable="true" 
							            rendered="#{nuovaSchedaWizard.segnalato.anagrafica.cittadinanza ne 'ITALIANA' and nuovaSchedaWizard.segnalato.anagrafica.cittadinanza2 ne 'ITALIANA' }">
								<webredcs:pnlStranieri iStranieri="#{nuovaSchedaWizard.stranieriMan}" />
							</p:fieldset>
						</p:outputPanel>
						
						<p:spacer height="10px" />
						<p:outputPanel>
						<table style="display: inline-block; vertical-align: top;">
						<tr><td>
						<p:fieldset legend="Recapiti attuali" style="display: inline-block; vertical-align: top;">
						   <p:tabView orientation="left" style="height:130px;width:600px;">
						    <p:tab title="Residenza *">
					    		<h:panelGrid columns="2" columnClasses="label, value" styleClass="grid">
					    		    <h:outputText value="Struttura residenziale di accoglienza" style="display: block; width: 150px;"/>
		        			  		<p:inputText  value="#{nuovaSchedaWizard.segnalato.strutturaAccoglienza}" size="25">
		        			  		  <p:ajax event="change" update="via_residenza,comune_residenza" process="@this" listener="#{nuovaSchedaWizard.segnalato.onChangeStruttura}"/>
		        			  		</p:inputText>
		        			
									<h:outputText value="Via " for="via_residenza" />
									<p:inputText style="text-transform: uppercase" label="Via residenza" id="via_residenza" maxlength="100" size="25" value="#{nuovaSchedaWizard.segnalato.residenza.via}" />
									<h:outputText value="Comune" for="comune_residenza" />
									<webred:pnlComune id="comune_residenza" comuneManBean="#{nuovaSchedaWizard.segnalato.residenza}" value="#{nuovaSchedaWizard.segnalato.residenza.comune}" />
								</h:panelGrid>
						    </p:tab>
						    <p:tab title="Domicilio *">
						    	<h:panelGrid columns="1">
										<p:selectBooleanCheckbox itemLabel="come residenza" value="#{nuovaSchedaWizard.segnalato.domicilio.comeResidenza}">
											<p:ajax update="domicilio" listener="#{nuovaSchedaWizard.segnalato.domicilioComeResidenzaChecked}" />
										</p:selectBooleanCheckbox>
									    <h:panelGroup id="domicilio">
										<h:panelGrid columns="2" columnClasses="label, value" styleClass="grid" >
											<h:outputText value="Via " for="via_domicilio" />
											<p:inputText style="text-transform: uppercase" label="Via domicilio" disabled="#{nuovaSchedaWizard.segnalato.domicilio.comeResidenza}"
											             id="via_domicilio" maxlength="100" size="25" value="#{nuovaSchedaWizard.segnalato.domicilio.via}" />

											<h:outputText value="Comune " for="comune_domicilio" />
											<webred:pnlComune id="comune_domicilio" comuneManBean="#{nuovaSchedaWizard.segnalato.domicilio}" 
											                  disabled="#{nuovaSchedaWizard.segnalato.domicilio.comeResidenza}"
											                  value="#{nuovaSchedaWizard.segnalato.domicilio.comune}" />
										</h:panelGrid>
									</h:panelGroup>
						    	</h:panelGrid>
						    </p:tab>
							<p:tab title="Altri *">
								<h:panelGrid columns="2" columnClasses="label, value" styleClass="grid">
									<h:outputText value="Telefono " for="tel_segnalato" />
									<p:inputText  label="Telefono" id="tel_segnalato" value="#{nuovaSchedaWizard.segnalato.tel}">
										<f:convertNumber integerOnly="true" />
									</p:inputText>
									<h:outputText value="Cellulare " for="cel_segnalato" />
									<p:inputText  label="Cellulare" id="cel_segnalato" value="#{nuovaSchedaWizard.segnalato.cel}">
										<f:convertNumber integerOnly="true" />
									</p:inputText>
									<h:outputText value="Email " for="email_segnalato" />
									<p:inputText label="Email" id="email_segnalato" value="#{nuovaSchedaWizard.segnalato.email}" />
	
								</h:panelGrid>
							</p:tab>
							</p:tabView>
						</p:fieldset>
						<p:fieldset legend="Formazione - Lavoro" style="display: inline-block; vertical-align: top;">
							<webredcs:pnlFormazioneLavoro iFormazioneLavoro="#{nuovaSchedaWizard.segnalato.formLavoroMan}" numColonne="2" 
							                              onChangeCondLavoro="#{nuovaSchedaWizard.onChangeCondLavoro()}"
							                              onChangeTitoloStudio="#{nuovaSchedaWizard.onChangeTitoloStudio()}"/>
						</p:fieldset>

					    </td></tr>
					    <tr><td>
						    <p:fieldset legend="Familiari e Conviventi"> 
								<p:outputPanel rendered="#{nuovaSchedaWizard.visPanelStranieri}">
								    <p:commandLink id="nucleoBtn" title="Mostra nucleo familiare"   style="float:right;"
								                   action="#{nuovaSchedaWizard.loadNucleoFamiliareSegnalato}"
								                   rendered="#{nuovaSchedaWizard.segnalato.anagrafica.codiceFiscale!=null}" 
								                   oncomplete="PF('dlgNucleoFamiliare').show();">
								           <h:graphicImage value="/images/famiglia.jpg" height="25" />
								     </p:commandLink>
								         
								
										<p:dialog header="Nucleo Familiare" widgetVar="dlgNucleoFamiliare" dynamic="true" height="400">
							    		    <p:dataTable var="soggettoNucleo" value="#{nuovaSchedaWizard.nucleoFamiliare}" rows="10" paginator="true" >
															               
											        <p:column headerText="Cognome" style="vertical-align:middle;width:15%" sortBy="cognome" >  
											            #{soggettoNucleo.cognome}  
											        </p:column>
											        
											        <p:column headerText="Nome" style="vertical-align:middle;width:15%" sortBy="nome" >  
											            #{soggettoNucleo.nome}  
											        </p:column>
											        
											        <p:column headerText="Codice fiscale" style="vertical-align:middle;width:15%" sortBy="cf" >  
											            #{soggettoNucleo.cf}  
											        </p:column>
											        
											        
											        <p:column headerText="Data di nascita" style="vertical-align:middle;width:8%" sortBy="dataNascita" >  
											            <h:outputText value="#{soggettoNucleo.dataNascita}" >
								                			<f:convertDateTime pattern="dd/MM/yyyy"  />
								            			</h:outputText>  
											        </p:column>
											        
											        <p:column style="text-align:center;vertical-align:middle;width:20px" >
											             <h:outputText value="#{soggettoNucleo.sesso}" rendered="#{soggettoNucleo.sesso ne 'F' and soggettoNucleo.sesso ne 'M'}" />  
											            <p:graphicImage rendered="#{soggettoNucleo.sesso  eq 'F'}" title="Donna" value="/images/female.png" height="20"/>
											            <p:graphicImage rendered="#{soggettoNucleo.sesso  eq 'M'}" title="Uomo" value="/images/male.png" height="20"/>
											        </p:column>
											        
											        <p:column headerText="Relazione" style="vertical-align:middle;"  sortBy="parentela" >  
											            #{soggettoNucleo.parentela}
											        </p:column>
										</p:dataTable>
									</p:dialog>
								
									<webredcs:pnlFamConviventi iFamConviventi="#{nuovaSchedaWizard.famConviventiMan}" numColonne="2" />
								</p:outputPanel>
								
							</p:fieldset>
					    </td></tr>
					    </table>
					    <p:outputPanel style="display: inline-block; vertical-align: top;" >
						<p:fieldset legend="Abitazione"  style="display: inline-block; vertical-align: top;" rendered="#{nuovaSchedaWizard.visPanelStranieri}">
							<webredcs:pnlAbitazione iAbitazione="#{nuovaSchedaWizard.abitazioneMan}" numColonne="2"/>
						</p:fieldset>
						<p:fieldset legend="Dati Sanitari"  >
							<h:panelGrid columns="2" >
								<h:outputText value="Medico medicina generale " for="medico_segnalato" title="Inserire Cognome e Nome" />
								<p:autoComplete label="Medico medicina generale" id="medico_segnalato" value="#{nuovaSchedaWizard.segnalato.medico}" title="Inserire Cognome e Nome" minQueryLength="3" style="text-transform: uppercase"
									completeMethod="#{nuovaSchedaWizard.completeMedico}" />
	                            
								<h:outputLabel value=" N.Tessera sanitaria " for="tessera_sanitaria_segnalato" />
								<p:inputText label="N.Tessera sanitaria" id="tessera_sanitaria_segnalato" value="#{nuovaSchedaWizard.segnalato.tesseraSanitaria}" />
							
								<p:selectBooleanCheckbox itemLabel="STP"  ivalue="#{nuovaSchedaWizard.segnalato.stp}"/>
								
								<h:panelGrid columns="3">
									<p:selectBooleanCheckbox itemLabel="Invalidità"  value="#{nuovaSchedaWizard.segnalato.invalidita}">
										<p:ajax event="change" update="perc_invalidita" process="@this" listener="#{nuovaSchedaWizard.segnalato.onChangeInvalidita}"/>
									</p:selectBooleanCheckbox>
									<p:spinner id="perc_invalidita" value="#{nuovaSchedaWizard.segnalato.percInvalidita}" 
									           disabled="#{!nuovaSchedaWizard.segnalato.invalidita}" min="0" max="100" size="3"/>
									<h:outputLabel value=" % "/>
								</h:panelGrid>
							
							</h:panelGrid>
						</p:fieldset>
						</p:outputPanel>
						</p:outputPanel>
					
						<p:separator />
						<webred:pnlRequiredSalva salvaAction="#{nuovaSchedaWizard.salvaTabUtente()}" 		 
												 renderRecupero="#{nuovaSchedaWizard.abilitaLoadPrecedente}"
						                         recuperoLastAction="#{nuovaSchedaWizard.valorizzaSegnalatoDaUltima()}" 
						                         panelToUpdate="pnlSegnalato"/>
						
					</p:panel>
				</p:tab>

				<p:tab id="riferimento" title="Riferimento">
					<p:panel id="pnlRiferimento" header="Persona di riferimento" toggleable="true" toggleSpeed="500" >

						<h:panelGrid columns="2" columnClasses="label, value" styleClass="grid">

							<p:selectBooleanCheckbox value="#{nuovaSchedaWizard.riferimento.comeSegnalante}">
								<p:ajax update="dati_riferimento" listener="#{nuovaSchedaWizard.riferimentoComeSegnalanteChecked}" />
							</p:selectBooleanCheckbox>
							<h:outputText value="Come interlocutore " for="come_segnalante_riferimento" />
						</h:panelGrid>

						<h:panelGrid id="dati_riferimento" columns="4" columnClasses="label, value" styleClass="grid">
							<h:outputText value="Cognome " for="cognome_riferimento" />
							<p:inputText label="Cognome" id="cognome_riferimento" style="text-transform: uppercase" disabled="#{nuovaSchedaWizard.riferimento.comeSegnalante}"
								value="#{nuovaSchedaWizard.riferimento.cognome}" />

							<h:outputText value="Nome " for="nome_riferimento" />
							<p:inputText label="Nome" id="nome_riferimento" style="text-transform: uppercase" disabled="#{nuovaSchedaWizard.riferimento.comeSegnalante}" value="#{nuovaSchedaWizard.riferimento.nome}" />
							
							<h:outputText value="Data di nascita " for="data_nascita_riferimento" />
							<webred:pnlData id="data_nascita_riferimento" dataValue="#{nuovaSchedaWizard.riferimento.dataNascita}" disabled="#{nuovaSchedaWizard.riferimento.comeSegnalante}"
												dataPattern="dd/MM/yyyy" dataPatternLabel="(gg/mm/aaaa)" yearRange="c-100:c+0" />
										    
							<h:outputText value="Luogo di nascita " for="citta_nascita_riferimento" />
							<h:panelGrid colums="1">
								<webred:pnlComuneNazione comuneNazioneManBean="#{nuovaSchedaWizard.riferimento.comuneNazioneNascitaMan}" disabled="#{nuovaSchedaWizard.riferimento.comeSegnalante}" extraLabelRequired="false" />
							</h:panelGrid>
							
							<h:outputText value="Stato civile " for="stato_civile_riferimento" />
							<p:selectOneMenu label="Stato civile" id="stato_civile_riferimento" disabled="#{nuovaSchedaWizard.riferimento.comeSegnalante}" 
												value="#{nuovaSchedaWizard.riferimento.codStatoCivile}" effect="fold" editable="false">
								<f:selectItem itemLabel="- seleziona -" itemValue="" />
								<f:selectItems value="#{nuovaSchedaWizard.statiCiviliSelectItem}" />
							</p:selectOneMenu>
							
							<h:outputText value="Sesso " for="sesso_riferimento" />
							<webred:pnlSesso value="#{nuovaSchedaWizard.riferimento.datiSesso}" disabled="#{nuovaSchedaWizard.riferimento.comeSegnalante}" />

							<h:outputText value="Telefono " for="telefono_riferimento" />
							<p:inputText label="Telefono " id="telefono_riferimento" disabled="#{nuovaSchedaWizard.riferimento.comeSegnalante}" value="#{nuovaSchedaWizard.riferimento.telefono}">
								<f:convertNumber integerOnly="true" />
							</p:inputText>
							
							<h:outputText value="Cellulare " for="cel_riferimento" />
							<p:inputText label="Cellulare" id="cel_riferimento" disabled="#{nuovaSchedaWizard.riferimento.comeSegnalante}" value="#{nuovaSchedaWizard.riferimento.cellulare}">
								<f:convertNumber integerOnly="true" />
							</p:inputText>

							<h:outputText value="Email " for="email_riferimento" />
							<p:inputText label="Email" id="email_riferimento" disabled="#{nuovaSchedaWizard.riferimento.comeSegnalante}" value="#{nuovaSchedaWizard.riferimento.email}" />

							<h:outputText value="Recapito " for="recapito_riferimento" />
							<p:inputText label="Recapito" id="recapito_riferimento" disabled="#{nuovaSchedaWizard.riferimento.comeSegnalante}" value="#{nuovaSchedaWizard.riferimento.recapito}" />
							
							<h:outputText value="Relazione " for="parentela_riferimento" />
							<p:selectOneMenu label="Relazione" id="parentela_riferimento" filter="true" filterMatchMode="contains" effect="fold" 
							                 value="#{nuovaSchedaWizard.riferimento.codRelazione}" 
							                 disabled="#{nuovaSchedaWizard.riferimento.comeSegnalante}">
								<f:selectItem noSelectionOption="true" itemLabel="- seleziona -" />
								<f:selectItems value="#{nuovaSchedaWizard.relazioni}" />
							</p:selectOneMenu>
					
							<p:spacer width="5px"/>
							
							<p:selectBooleanCheckbox label="Eventuali problemi" id="problemi_riferimento" value="#{nuovaSchedaWizard.riferimento.problemi}" itemLabel="Eventuali problemi">
								<p:ajax update="quali_problemi_riferimento" listener="#{nuovaSchedaWizard.setProblemiRiferimentoChanged}" />
							</p:selectBooleanCheckbox>
							
							<h:outputText value="Specificare quali" for="quali_problemi_riferimento" />
							<p:inputText label="Specificare quali" id="quali_problemi_riferimento" disabled="#{nuovaSchedaWizard.specificareProblemiDisabled}" value="#{nuovaSchedaWizard.riferimento.qualiProblemi}" />

						</h:panelGrid>
						<p:separator />
						<webred:pnlRequiredSalva salvaAction="#{nuovaSchedaWizard.salvaTabRiferimento()}" 	 
												 renderRecupero="#{nuovaSchedaWizard.abilitaLoadPrecedente}"
						                         recuperoLastAction="#{nuovaSchedaWizard.valorizzaRiferimentoDaUltima()}" 
						                         panelToUpdate="pnlRiferimento"/>
						
					</p:panel>
				</p:tab>

				<p:tab id="motivazione" title="Bisogni">
					<p:panel id="pnlMotivazioni" header="Bisogni" toggleable="true" toggleSpeed="500">
						<p:spacer />
						<p:spacer />
						<h:panelGrid columns="1">
						   <h:outputLabel value="Inserire i bisogni ESPRESSI dall'utente o dall'interlocutore" />
							<h:panelGrid columns="2">
								<p:outputPanel style="display: inline-block; vertical-align:top;">
									<p:remoteCommand name="refreshPanel" action="#{nuovaSchedaWizard.visual}" update="display1, display2, display3, display4, display5" />

									<h:panelGrid id="display1" columns="1" style="display: inline-block; vertical-align: top;" rendered="#{!empty nuovaSchedaWizard.motivazioni1}">
										<p:selectCheckboxMenu disabled="false" label="Fisiologici" id="motivazioni1" style="width:200px;margin-top:10px" onHide="refreshPanel()"
											value="#{nuovaSchedaWizard.motivazione.classe1.motiviSelected}">
											<f:selectItems value="#{nuovaSchedaWizard.motivazioni1}" />
										</p:selectCheckboxMenu>
										<p:outputPanel style="width:200px;margin-top:10px">
											<p:dataList value="#{nuovaSchedaWizard.motivazione.classe1.motiviDescrizione}" var="motivazioni1" emptyMessage="-">
	            	    #{motivazioni1.motivo}
	        		</p:dataList>
										</p:outputPanel>
									</h:panelGrid>

									<h:panelGrid id="display2" columns="1" style="display: inline-block; vertical-align: top;" rendered="#{!empty nuovaSchedaWizard.motivazioni2}">
										<p:selectCheckboxMenu disabled="false" label="Sicurezza e Protezione" id="motivazioni2" style="width:200px;margin-top:10px" onHide="refreshPanel()"
											value="#{nuovaSchedaWizard.motivazione.classe2.motiviSelected}">
											<f:selectItems value="#{nuovaSchedaWizard.motivazioni2}" />
										</p:selectCheckboxMenu>
										<p:outputPanel style="width:200px;margin-top:10px">
											<p:dataList value="#{nuovaSchedaWizard.motivazione.classe2.motiviDescrizione}" var="motivazioni2" emptyMessage="-">
	            		#{motivazioni2.motivo}
	        		</p:dataList>
										</p:outputPanel>
									</h:panelGrid>

									<h:panelGrid id="display3" columns="1" style="display: inline-block; vertical-align: top;" rendered="#{!empty nuovaSchedaWizard.motivazioni3}">
										<p:selectCheckboxMenu disabled="false" label="Appartenenza" id="motivazioni3" style="width:200px;margin-top:10px" onHide="refreshPanel()"
											value="#{nuovaSchedaWizard.motivazione.classe3.motiviSelected}">
											<f:selectItems value="#{nuovaSchedaWizard.motivazioni3}" />
										</p:selectCheckboxMenu>
										<p:outputPanel style="width:200px;margin-top:10px">
											<p:dataList value="#{nuovaSchedaWizard.motivazione.classe3.motiviDescrizione}" var="motivazioni3" emptyMessage="-">
	            		#{motivazioni3.motivo}
	        		</p:dataList>
										</p:outputPanel>
									</h:panelGrid>

									<h:panelGrid id="display4" columns="1" style="display: inline-block; vertical-align: top;" rendered="#{!empty nuovaSchedaWizard.motivazioni4}">
										<p:selectCheckboxMenu disabled="false" label="Realizzazione" id="motivazioni4" style="width:200px;margin-top:10px" onHide="refreshPanel()"
											value="#{nuovaSchedaWizard.motivazione.classe4.motiviSelected}">
											<f:selectItems value="#{nuovaSchedaWizard.motivazioni4}" />
										</p:selectCheckboxMenu>
										<p:outputPanel style="width:200px;margin-top:10px">
											<p:dataList value="#{nuovaSchedaWizard.motivazione.classe4.motiviDescrizione}" var="motivazioni4" emptyMessage="-">
	            		#{motivazioni4.motivo}
	        		</p:dataList>
										</p:outputPanel>
									</h:panelGrid>

									<h:panelGrid id="display5" columns="1" style="display: inline-block; vertical-align: top;" rendered="#{!empty nuovaSchedaWizard.motivazioni5}">
										<p:selectCheckboxMenu disabled="false" label="Autorealizzazione" id="motivazioni5" style="width:200px;margin-top:10px" onHide="refreshPanel()"
											value="#{nuovaSchedaWizard.motivazione.classe5.motiviSelected}">
											<f:selectItems value="#{nuovaSchedaWizard.motivazioni5}" />
										</p:selectCheckboxMenu>
										<p:outputPanel style="width:200px;margin-top:10px">
											<p:dataList value="#{nuovaSchedaWizard.motivazione.classe5.motiviDescrizione}" var="motivazioni5" emptyMessage="-">
	            		#{motivazioni5.motivo}
	        		</p:dataList>
										</p:outputPanel>
									</h:panelGrid>

								</p:outputPanel>

							</h:panelGrid>
							<h:panelGrid columns="2" style="display: inline-block; vertical-align: top;">
								<webred:pnlNota id="altre_motivazioni" notaLabel="Specificare meglio il bisogno:" notaValue="#{nuovaSchedaWizard.motivazione.altro}"  />
							</h:panelGrid>

							<p:spacer height="10px" />

							<p:panel header="Note di diario" toggleable="true" collapsed="true">
								<p:outputPanel style="display: inline-block; vertical-align:top;">
								    <h:panelGrid columns="1" style="display: inline-block; vertical-align: top;">
										<webred:pnlNota id="diario_pubblico_motivazione" notaLabel="Visibile a tutti" notaValue="#{nuovaSchedaWizard.notaDiarioPubblica.nota}"  />
									</h:panelGrid>
									<h:panelGrid columns="1" style="display: inline-block; vertical-align: top;">
										<webred:pnlNota id="diario_privato_motivazione" notaLabel="Privata " notaValue="#{nuovaSchedaWizard.notaDiarioPrivata.nota}" />
									</h:panelGrid>
								</p:outputPanel>
							</p:panel>
						</h:panelGrid>
						<p:separator />
						<webred:pnlRequiredSalva salvaAction="#{nuovaSchedaWizard.salvaTabBisogni()}"
						 						 renderRecupero="#{nuovaSchedaWizard.abilitaLoadPrecedente}"
						                         recuperoLastAction="#{nuovaSchedaWizard.valorizzaMotivazioniDaUltima()}" 
						                         panelToUpdate="pnlMotivazioni"/>
						
					</p:panel>

					<p:spacer height="5px" />
					<p:panel header="Diario Sociale" collapsed="true" toggleable="true" toggleSpeed="500">
						<ui:repeat value="#{nuovaSchedaWizard.diarioSociale.note}" var="nota">
							<p:fieldset legend="#{nota.descOperatore}: #{nota.ente.nome}, #{nota.formattedData} - nota #{nota.tipologia}" toggleable="true" collapsed="true" toggleSpeed="500">
								<h:panelGrid columns="1" cellpadding="10">
									<h:outputText value="#{nota.nota}" />
								</h:panelGrid>
							</p:fieldset>
							<p:spacer height="5px" />
						</ui:repeat>
					</p:panel>

				</p:tab>

				<p:tab id="interventi" title="Servizi Richiesti">
					<p:panel header="Interventi eseguiti" toggleable="true" toggleSpeed="500"
					         rendered="#{preselPuntoContatto.puntoContatto.ufficio.visInterventi and not empty nuovaSchedaWizard.interventiErogati}" >
						<p:dataTable value="#{nuovaSchedaWizard.interventiErogati}" var="inte" emptyMessage="Nessun intervento erogato">
							<p:column headerText="Tipo"><h:outputText value="#{inte.tipoIntervento}" /></p:column>
							<p:column headerText="Org. erogante" style="text-align:center;"><h:outputText value="#{inte.organizzazione}" /></p:column>
							<p:column headerText="num.interventi" style="text-align:center;"><h:outputText value="#{inte.numero}" /></p:column>
							<p:column headerText="Ultima erogazione" style="text-align:center;">
								<h:outputText value="#{inte.dataUltimaErogazione}" >
									<f:convertDateTime pattern="dd/MM/yyyy" />
								</h:outputText>
							</p:column>
						</p:dataTable>
					</p:panel>
					
					<p:panel id="pnlInterventi" header="Servizi richiesti" toggleable="true" toggleSpeed="500">
						<h:panelGrid columns="2" columnClasses="label, value" styleClass="grid">

							<h:outputText />

							<p:selectManyCheckbox label="Selezionare interventi" id="interventi_richiesti" value="#{nuovaSchedaWizard.intervento.interventi}" layout="grid" columns="3">
								<f:selectItems value="#{nuovaSchedaWizard.interventi}" />
							</p:selectManyCheckbox>

							<h:outputText value="Altro " for="altri_interventi_richiesti" />
							<p:inputText label="Altro servizio (specificare)" id="altri_interventi_richiesti" value="#{nuovaSchedaWizard.intervento.altro}" />

						</h:panelGrid>
						<p:spacer height="20px" />

						<p:accordionPanel multiple="true" activeIndex="-1" rendered="#{nuovaSchedaWizard.visPanelStranieri}">
							<p:tab title="Intermediazione Abitativa">
								<webredcs:pnlIntermediazioneAb iIntermediazioneAb="#{nuovaSchedaWizard.intermediazioneAbMan}" />
							</p:tab>
							<p:tab title="Orientamento / Inserimento Lavoro">
								<webredcs:pnlInserimentoLavoro OrientamentoLavoroManBean="#{nuovaSchedaWizard.orientamentoLavoroManBean}" />
							</p:tab>
                            <p:tab title="Mediazione Culturale">
                                <webredcs:pnlMediazioneCult iMediazioneCult="#{nuovaSchedaWizard.mediazioneCultMan}" />
                            </p:tab>
                            <p:tab title="Orientamento all'istruzione / formazione">
                                <webredcs:pnlOrientamentoIstruzione iOrientamentoIstruzione="#{nuovaSchedaWizard.orientamentoIstruzioneMan}" />
                            </p:tab>
						</p:accordionPanel>

						<p:spacer height="10px" />

						<h:panelGrid rendered="#{nuovaSchedaWizard.renderInterventoEconomico()}" columns="4" columnClasses="label, value" styleClass="grid">

							<h:outputText value="Intervento economico " for="intervento_economico_tipo" />
							<p:selectOneMenu label="Intervento economico" id="intervento_economico_tipo" value="#{nuovaSchedaWizard.interventoEconomicoTipo}" effect="fold" editable="false">
								<f:selectItem itemLabel="- seleziona -" itemValue="" />
								<f:selectItems value="#{nuovaSchedaWizard.interventiEconomiciTipi}" />
							</p:selectOneMenu>

							<h:outputText value="Importo in € " for="intervento_economico_importo" />
							<p:inputText label="Importo" id="intervento_economico_importo" size="5" value="#{nuovaSchedaWizard.interventoEconomicoImporto}" />

						</h:panelGrid>

						<p:spacer height="10px" />
						<p:panel header="Note di diario" toggleable="true" collapsed="true">
							<p:outputPanel style="display: inline-block; vertical-align:top;">
								<webred:pnlNota id="diario_pubblico_servizi" notaLabel="Visibile a tutti" notaValue="#{nuovaSchedaWizard.notaDiarioPubblica.nota}" />
							</p:outputPanel>
						</p:panel>
						<p:separator />
						<webred:pnlRequiredSalva salvaAction="#{nuovaSchedaWizard.salvaTabServiziRichiesti()}"  
											     renderRecupero="#{nuovaSchedaWizard.abilitaLoadPrecedente}"
						                         recuperoLastAction="#{nuovaSchedaWizard.valorizzaInterventiDaUltima()}" 
						                         panelToUpdate="pnlInterventi"/>
					</p:panel>

					<p:spacer height="5px" />

					<p:panel header="#{nuovaSchedaWizard.getInterventiEconomiciHeader()}" rendered="#{nuovaSchedaWizard.showInterventiEconomici}" collapsed="true" toggleable="true" toggleSpeed="500">

						<p:dataTable var="intervento" value="#{nuovaSchedaWizard.interventiEconomici.interventi}" rows="10" paginator="true"
							paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" rowsPerPageTemplate="5,10,15" sortBy="data">

							<p:column headerText="Data" sortBy="data">
								<h:outputText value="#{intervento.data}">
									<f:convertDateTime pattern="dd/MM/yyyy" />
								</h:outputText>
							</p:column>

							<p:column headerText="Importo in €">
								<h:outputText value="#{intervento.importo}" />
							</p:column>

							<p:column headerText="Tipo" sortBy="tipo">
								<h:outputText value="#{intervento.tipo}" />
							</p:column>

							<p:column headerText="Ente erogante" sortBy="erogante">
								<h:outputText value="#{intervento.erogante}" />
							</p:column>
						</p:dataTable>

					</p:panel>

					<p:spacer height="5px" />

					<p:panel header="Diario Sociale" collapsed="true" toggleable="true" toggleSpeed="500">
						<ui:repeat value="#{nuovaSchedaWizard.diarioSociale.note}" var="nota">
							<p:fieldset legend="#{nota.descOperatore}: #{nota.ente.nome}, #{nota.formattedData} - nota #{nota.tipologia}" toggleable="true" collapsed="true" toggleSpeed="500">
								<h:panelGrid columns="1" cellpadding="10">
									<h:outputText value="#{nota.nota}" />
								</h:panelGrid>
							</p:fieldset>
							<p:spacer height="5px" />
						</ui:repeat>
					</p:panel>
				</p:tab>

				<p:tab id="chiusura" title="Interventi">
					<p:panel header="Interventi previsti" toggleable="true" toggleSpeed="500">
						<p:outputPanel style="float:right;background:#f9fbfd !important; width:300px;">
							<h:outputText value="Cartella Sociale non presente per il soggetto" rendered="#{nuovaSchedaWizard.statoCartella==null}" style="font-weight:bold;color:red;" />
							<h:outputText value="Trovata Cartella Sociale per il soggetto con stato: " rendered="#{nuovaSchedaWizard.statoCartella!=null}" style="font-weight:bold;color:green;" />
							<h:outputText value="#{nuovaSchedaWizard.statoCartella}" rendered="#{nuovaSchedaWizard.statoCartella!=null}" escape="false" />
						</p:outputPanel>

						<h:panelGrid columns="2" columnClasses="label, value" styleClass="grid" >

							<h:outputText value="Tipo di intervento *" for="tipo_intervento" />
							<p:selectOneMenu label="Tipo di intervento" id="tipo_intervento" required="true" value="#{nuovaSchedaWizard.tipoScheda}" effect="fold" editable="false">
								<f:selectItem itemLabel="- seleziona -" itemValue="" />
								<f:selectItems value="#{nuovaSchedaWizard.tipiScheda}" />
								<p:ajax update="categoria_sociale" event="change" listener="#{nuovaSchedaWizard.resetCatSociale}"></p:ajax>
							</p:selectOneMenu>

							<h:outputText value="Categoria sociale" for="categoria_sociale" />
							<p:selectOneMenu label="Categoria sociale" id="categoria_sociale" value="#{nuovaSchedaWizard.categoriaSociale}" disabled="#{nuovaSchedaWizard.tipoScheda!=3 and nuovaSchedaWizard.tipoScheda!=6}" effect="fold" editable="false">
								<f:selectItem itemLabel="- seleziona -" itemValue="" />
								<f:selectItems value="#{nuovaSchedaWizard.categorieSociali}" />
							</p:selectOneMenu>
													
						</h:panelGrid>
						
						<p:outputPanel>
							<h:panelGrid columns="4" rendered="#{nuovaSchedaWizard.privacy==null}" >
								<p:commandButton id="privacyButton"  ajax="false" onclick="PrimeFaces.monitorDownload(start, stop);" 
				            		value="Privacy" title="Download PDF del Modulo Privacy" icon="ui-icon-key" disabled="#{nuovaSchedaWizard.disableComponent(nuovaSchedaWizard.canPrint())}" >
				            		<p:fileDownload value="#{nuovaSchedaWizard.filePrivacy}" />
				            	</p:commandButton>
								<p:selectBooleanCheckbox itemLabel="Modulo privacy sottoscritto in data " value="#{nuovaSchedaWizard.privacySottoscrivi}"/>
								<webred:pnlData  dataValue="#{nuovaSchedaWizard.privacyDate}" dataPattern="dd/MM/yyyy" dataPatternLabel="(gg/mm/aaaa)"/>
							</h:panelGrid>
						    <h:panelGrid columns="2" rendered="#{nuovaSchedaWizard.privacy!=null}" >											 
								<p:graphicImage value="/images/signature-ok.png" width="25px" />  
								<p:outputLabel value="#{nuovaSchedaWizard.privacyMessaggio}" rendered="#{nuovaSchedaWizard.privacy!=null}" style="font-weight:bold;"/>
							</h:panelGrid>
						</p:outputPanel>

						<p:spacer height="20px" />

						<p:panel header="Note di diario" toggleable="true" collapsed="true">
							<p:outputPanel style="display: inline-block; vertical-align:top;">
								<h:panelGrid columns="1" style="display: inline-block; vertical-align: top;">
									<webred:pnlNota id="diario_pubblico_interventi" notaLabel="Visibile a tutti"  notaValue="#{nuovaSchedaWizard.notaDiarioPubblica.nota}" />
								</h:panelGrid>
								<h:panelGrid columns="1" style="display: inline-block; vertical-align: top;">
									<webred:pnlNota id="diario_privato_interventi" notaLabel="Privata" notaValue="#{nuovaSchedaWizard.notaDiarioPrivata.nota}" />
								</h:panelGrid>
							</p:outputPanel>
						</p:panel>

						<p:spacer height="5px" />
						<p:separator />
                       
                        <webred:pnlRequiredSalva salvaAction="#{nuovaSchedaWizard.salvaSchedaCompletaUDC()}" />
					</p:panel>

					<p:spacer height="5px" />

					<p:panel header="Diario Sociale" collapsed="true" toggleable="true" toggleSpeed="500">
						<ui:repeat value="#{nuovaSchedaWizard.diarioSociale.note}" var="nota">
							<p:fieldset legend="#{nota.descOperatore}: #{nota.ente.nome}, #{nota.formattedData} - nota #{nota.tipologia}" toggleable="true" collapsed="true" toggleSpeed="500">
								<h:panelGrid columns="1" cellpadding="10">
									<h:outputText value="#{nota.nota}" />
								</h:panelGrid>
							</p:fieldset>
							<p:spacer height="5px" />
						</ui:repeat>
					</p:panel>


				</p:tab>

			</p:wizard>
			
	
			
		</h:form>
	

	</ui:define>

</ui:composition>
</html>