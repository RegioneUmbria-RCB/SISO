<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:webred="http://java.sun.com/jsf/composite/webred"
	xmlns:webredcs="http://java.sun.com/jsf/composite/webredcs">


<p:panel id="pnlTestata" header="Testata" toggleable="true" styleClass="#{'updateOnListaErogazioniChange updateFlagAttivazioneChange'}">
   <p:growl id="growl2" life="2000" />
      	<p:spacer height="20px"/>		     
      <h:panelGrid columns="3" cellpadding="0" style="float:right;" rendered="#{fglInterventoBean.erogazioneInterventoBean.nuovoIntEsegMast.dtIns!=null}" >
		 <h:outputLabel value="Inserimento: "  style="font-weight:bold"/>
		  <h:outputText value="#{fglInterventoBean.erogazioneInterventoBean.nuovoIntEsegMast.dtIns}" >
		 	<f:convertDateTime pattern="dd/MM/yyyy" />
		 </h:outputText>
		 <h:outputText value="da #{fglInterventoBean.erogazioneInterventoBean.getCognomeNomeUtente(fglInterventoBean.erogazioneInterventoBean.nuovoIntEsegMast.userIns)}" />
		
		 <h:outputLabel value="Ultima Modifica:"  style="font-weight:bold"
		 				rendered="#{fglInterventoBean.erogazioneInterventoBean.nuovoIntEsegMast.usrMod != NULL || fglInterventoBean.erogazioneInterventoBean.nuovoIntEsegMast.usrMod != NULL}" />
		  <h:outputText value="#{fglInterventoBean.erogazioneInterventoBean.nuovoIntEsegMast.dtMod}" 
		  				rendered="#{fglInterventoBean.erogazioneInterventoBean.nuovoIntEsegMast.dtMod != NULL}" >
			 <f:convertDateTime pattern="dd/MM/yyyy" />
		 </h:outputText> 
		 <h:outputText value="da #{fglInterventoBean.erogazioneInterventoBean.getCognomeNomeUtente(fglInterventoBean.erogazioneInterventoBean.nuovoIntEsegMast.usrMod)}"  
		 			   rendered="#{fglInterventoBean.erogazioneInterventoBean.nuovoIntEsegMast.usrMod != NULL}"/>
	</h:panelGrid>
   
   <h:panelGrid columns="3">
      <p:outputLabel value="INTERVENTO" />

      <h:panelGroup>
         <p:outputLabel value="Tipo: " />
         <p:outputLabel value="'#{fglInterventoBean.erogazioneInterventoBean.nomeTipoErogazione}'" style="font-weight:bold" />
      </h:panelGroup>

      <h:panelGroup>
         <p:outputLabel value="Tipo Specifico: " />
         <p:outputLabel value="#{fglInterventoBean.erogazioneInterventoBean.nomeTipoCustEroga!=null ? fglInterventoBean.erogazioneInterventoBean.nomeTipoCustEroga : '-'}" style="font-weight:bold" />
      </h:panelGroup>
      
      <p:outputPanel rendered="#{fglInterventoBean.paidto != null}" layout="inline">
             <p:outputLabel value="Soggetto Progetto: " />
             <p:outputLabel value="#{fglInterventoBean.paidto.pai.csDDiario.csACaso.csASoggetto.csAAnagrafica.cognome} #{fglInterventoBean.paidto.pai.csDDiario.csACaso.csASoggetto.csAAnagrafica.nome}" style="font-weight:bold" />
      </p:outputPanel>
      
      <p:outputPanel rendered="#{fglInterventoBean.paidto != null}" layout="inline">
          <p:outputLabel value="Progetto: " />
          <p:outputLabel value="#{fglInterventoBean.paidto.pai.csTbTipoPai.descrizione}" />
      </p:outputPanel>
      
      <p:outputPanel rendered="#{fglInterventoBean.paidto != null}" layout="inline">
          <h:panelGrid columns="2">
              <p:outputLabel value="Data inizio: " />
              <p:outputLabel value="#{fglInterventoBean.paidto.pai.csDDiario.dtAttivazioneDa}" />
              <p:outputLabel value="Data chiusura: " />
              <p:outputLabel value="#{fglInterventoBean.paidto.pai.csDDiario.dtAttivazioneA}" />
          </h:panelGrid>
      </p:outputPanel>
      
      <h:panelGrid columns="2">
         <p:outputLabel for="cbxSettErogante" value="Erogatore / Attuatore" />
          <webredcs:tooltipInfo title="Settore erogante" stringDescr="#{fglInterventoBean.erogazioneInterventoBean.tooltipText.settoreErogante}" />
      </h:panelGrid>
      
      <p:selectOneMenu id="cbxSettErogante" filter="true" filterMatchMode="contains"
         value="#{fglInterventoBean.erogazioneInterventoBean.selSettoreEroganteId}"
         disabled="#{fglInterventoBean.erogazioneInterventoBean.testataDisabled or !fglInterventoBean.richiediInterventi}">
         <p:ajax event="change" update="lblOrgErogante parentDettaglio @parent:@parent:@parent:pnlDettaglio:pnlOperatoreScegliOrInserisci"
            listener="#{fglInterventoBean.erogazioneInterventoBean.onSettEroganteTestaChange}"/>
         <f:selectItem itemLabel="- seleziona -" noSelectionOption="true" />
         <f:selectItems value="#{fglInterventoBean.erogazioneInterventoBean.listaSettoriErGroup}" />
      </p:selectOneMenu>
      <p:outputLabel id="lblOrgErogante" value="#{fglInterventoBean.erogazioneInterventoBean.descOrgEroganteId}" />
      
      <!-- #ROMACAPITALE -->
      <h:panelGroup id="parentDettaglio">
      <p:outputPanel id="pannelloDettaglioErogante" rendered="#{fglInterventoBean.erogazioneInterventoBean.visualizzaPannelloDettaglio}" layout="inline">
          <p:fieldset toggleable="false" >
				<h:panelGrid columns="2">						
					<p:outputLabel rendered="#{fglInterventoBean.erogazioneInterventoBean.settoreSelezionato.csAAnaIndirizzo.indirizzo != null}" value="Indirizzo: " style="font-weight:bold" ></p:outputLabel>
					<p:outputLabel rendered="#{fglInterventoBean.erogazioneInterventoBean.settoreSelezionato.csAAnaIndirizzo.indirizzo != null}" 
						value="#{fglInterventoBean.erogazioneInterventoBean.settoreSelezionato.csAAnaIndirizzo.indirizzo.concat(', ').concat(fglInterventoBean.erogazioneInterventoBean.settoreSelezionato.csAAnaIndirizzo.civicoNumero).concat(' - ').concat(fglInterventoBean.erogazioneInterventoBean.settoreSelezionato.csAAnaIndirizzo.comDes).concat(', ').concat(fglInterventoBean.erogazioneInterventoBean.settoreSelezionato.csAAnaIndirizzo.prov)}" ></p:outputLabel>
					<p:outputLabel rendered="#{fglInterventoBean.erogazioneInterventoBean.settoreSelezionato.tel != null}" value="Telefono: " style="font-weight:bold" />
					<p:outputLabel rendered="#{fglInterventoBean.erogazioneInterventoBean.settoreSelezionato.tel != null}" value="#{fglInterventoBean.erogazioneInterventoBean.settoreSelezionato.tel}" />
					<p:outputLabel rendered="#{fglInterventoBean.erogazioneInterventoBean.settoreSelezionato.email != null}" value="E-mail: " style="font-weight:bold" />
					<p:outputLabel rendered="#{fglInterventoBean.erogazioneInterventoBean.settoreSelezionato.email != null}" value="#{fglInterventoBean.erogazioneInterventoBean.settoreSelezionato.email}" />
				</h:panelGrid>
			</p:fieldset>
      </p:outputPanel>
      </h:panelGroup>

      <!-- SISO-663 SM
      </h:panelGrid>
      <p:selectBooleanCheckbox id="rbtDelegatoZona" itemLabel="delegato all'ente associativo"
         value="#{fglInterventoBean.erogazioneInterventoBean.nuovoIntEsegMast.gestZona}"
         disabled="#{!fglInterventoBean.erogazioneInterventoBean.erogazionePossibile or fglInterventoBean.erogazioneInterventoBean.testataDisabled}"
      />
          -->


		<!-- SISO-1136 :: i componenti seguenti non sono più renderizzati -->
		<!-- 
		
		<h:panelGrid columns="2" rendered="false">
			<p:outputLabel value="Gestione della spesa" for="sobGestioneSpesa" />
			<webredcs:tooltipInfo title="Ente gestore della spesa"
				valueList="#{fglInterventoBean.erogazioneInterventoBean.tooltipText.gestoriSpesa}" />
		</h:panelGrid>
		<p:selectOneButton id="sobGestioneSpesa" styleClass="#{'onChangeTitolare'}" 
				value="#{fglInterventoBean.erogazioneInterventoBean.ruoloEnteGestoreSpesa}"
				disabled="#{!fglInterventoBean.erogazioneInterventoBean.erogazionePossibile or fglInterventoBean.erogazioneInterventoBean.testataDisabled}"
				rendered="false">
			<f:selectItems value="#{fglInterventoBean.erogazioneInterventoBean.entiGestoriSpesa}" />
			<p:ajax event="change" listener="#{fglInterventoBean.erogazioneInterventoBean.sobGestioneSpesaOnChange}"
				update="lblGestioneSpesa sobGestioneSpesa" />
		</p:selectOneButton>
		<p:outputLabel id="lblGestioneSpesa" styleClass="#{'onChangeTitolare'}"
					   value="#{fglInterventoBean.erogazioneInterventoBean.nomeEnteGestoreSpesa}" rendered="false"/>
		 SISO-1136 -->
   </h:panelGrid>


   <!-- inizio MOD-RL -->


   <h:panelGrid id="pnlPrestazioneSocialeAgevolata" columns="2">

      <!-- SISO-657 txtProtocolloDomandaPrestazione sempre obbligatorio -->
      <p:outputLabel value="Domanda prestazione: "/>
      <h:panelGrid columns="4">
	      <p:outputLabel id="lblProtocolloDomandaPrestazione" value="n° protocollo &#42;" />
	      <p:inputText id="txtProtocolloDomandaPrestazione" style="width:220px"
	         value="#{fglInterventoBean.erogazioneInterventoBean.nuovoIntEsegMast.protDomPrest}" maxlength="32"
	         disabled="#{!fglInterventoBean.erogazioneInterventoBean.erogazionePossibile or 
	         			  fglInterventoBean.erogazioneInterventoBean.testataDisabled or
	         			  fglInterventoBean.erogazioneInterventoBean.protDomPrestDisabled}"/>
	
	      <!--         <p:selectBooleanCheckbox id="sbcSituazioneEconomicaVerificata" styleClass="sbcSituazioneEconomicaVerificataClass" 
	        			value="#{fglInterventoBean.erogazioneInterventoBean.situazioneEconomicaVerificata}" 
				        widgetVar="sbcSituazioneEconomicaVerificataWV"
				        itemLabel="Situazione economica verificata"   
						disabled="#{fglInterventoBean.erogazioneInterventoBean.situazioneEconomicaVerificataDisabled}"  > 
			            <p:ajax listener="#{fglInterventoBean.erogazioneInterventoBean.situazioneEconomicaVerificataListener}"  
							process="@this txtProtocolloDomandaPrestazione" 
							update="pgDatiIseePerInps pnlPrestazioneSocialeAgevolata" /> 
	        </p:selectBooleanCheckbox> -->
		
		  <p:outputLabel id="lblDataDomandaPrestazione" value="data" />
		  <webred:pnlData id="dataDomandaPrestazione" 
		   				   disabled="#{!fglInterventoBean.erogazioneInterventoBean.erogazionePossibile or 
	         			  fglInterventoBean.erogazioneInterventoBean.testataDisabled or
	         			  fglInterventoBean.erogazioneInterventoBean.protDomPrestDisabled}"
	               dataValue="#{fglInterventoBean.erogazioneInterventoBean.nuovoIntEsegMast.dataDomPrest}" dataPattern="dd/MM/yyyy"
	               dataPatternLabel="gg/mm/aaaa"/>
	  </h:panelGrid>
      <h:panelGrid columns="2">
         <p:outputLabel id="lblProvaMezzi" for="cbxProvaMezzi" value="Prova dei mezzi *" />
         <webredcs:tooltipInfo title="Prova dei Mezzi" valueList="#{fglInterventoBean.erogazioneInterventoBean.provaMezziValueList}" />
      </h:panelGrid>
      <p:selectOneMenu id="cbxProvaMezzi" style="width:350px"
         value="#{fglInterventoBean.erogazioneInterventoBean.csIPs.flagProvaMezzi}"
         disabled="#{!fglInterventoBean.erogazioneInterventoBean.erogazionePossibile or 
         			  fglInterventoBean.erogazioneInterventoBean.testataDisabled or
         			  fglInterventoBean.erogazioneInterventoBean.provaMezziDisabled}">
         <p:ajax event="change" partialSubmit="true" process="@this"
            listener="#{fglInterventoBean.erogazioneInterventoBean.cbxProvaMezziListener}" update="pgDatiIseePerInps"/>
         <f:selectItems value="#{fglInterventoBean.erogazioneInterventoBean.listaOpzioniProvaMezzi}" />
      </p:selectOneMenu>

   </h:panelGrid>

   <h:panelGroup id="pgDatiIseePerInps" styleClass="pgDatiIseePerInpsClass">
      <p:fieldset id="flsDatiIseePerInps" legend="SIUSS" style="margin-bottom: 20px;margin-top: 10px">
         <p:outputLabel value="Se non si inseriscono i dati della DSU verrà comunicato a SIUSS che la DSU non è disponibile"
            style="font-weight:bold;color:red;" rendered="#{fglInterventoBean.erogazioneInterventoBean.situazioneEconomicaVerificata}"/>
         <h:panelGrid id="pnlDatiIseePerInps" columns="2" width="100%">
            <p:outputLabel id="lblCodicePrestazione" for="cbxCodicePrestazione" 
            			   value="#{fglInterventoBean.erogazioneInterventoBean.labelCodicePrestazione}"  
            			   required="#{fglInterventoBean.erogazioneInterventoBean.isCodiceInpsObbligatorio}" />
            <p:selectOneMenu id="cbxCodicePrestazione" style="width:400px" panelStyleClass="selectOneMenuGrouped"
               value="#{fglInterventoBean.erogazioneInterventoBean.csIPs.codPrestazione}"
               disabled="#{fglInterventoBean.erogazioneInterventoBean.codPrestazioneDisabled or 
               			  !fglInterventoBean.erogazioneInterventoBean.erogazionePossibile or 
               			   fglInterventoBean.erogazioneInterventoBean.testataDisabled}">
               <f:selectItem noSelectionOption="true" itemLabel="- seleziona -" />
               <f:selectItems value="#{fglInterventoBean.erogazioneInterventoBean.listaCodiciPrestazione}" />
            </p:selectOneMenu>

			<p:outputLabel id="lblPresoInCarico" for="cbxPresoInCarico" value="Durante il servizio il beneficiario è in carico? " />
            <h:panelGrid  id="pnlPresoInCarico" columns="2" > 
               <p:selectOneRadio id="cbxPresoInCarico" value="#{fglInterventoBean.erogazioneInterventoBean.csIPs.flagInCarico}"
                   disabled="#{fglInterventoBean.erogazioneInterventoBean.codPrestazioneDisabled}">
                  <f:selectItems value="#{fglInterventoBean.erogazioneInterventoBean.listaOpzioniPresoInCarico}" />
                  <p:ajax listener="#{fglInterventoBean.erogazioneInterventoBean.radioClick}"/>
               </p:selectOneRadio>
               <webredcs:tooltipInfo stringDescr="Se si sceglie 'Non so' verrà rimandata ad una fase successiva la
                 specifica sulla presa in carico o meno necessaria per l'invio della prestazione al SIUSS"/>
             </h:panelGrid>
			
            <p:outputLabel id="lblDataDsu" for="dataDsu" value="Data presentazione dsu"
               rendered="#{fglInterventoBean.erogazioneInterventoBean.situazioneEconomicaVerificata}"/>
            <webred:pnlData id="dataDsu" disabled="#{fglInterventoBean.erogazioneInterventoBean.dataDsuDisabled}"
               dataValue="#{fglInterventoBean.erogazioneInterventoBean.csIPs.dataDSU}" dataPattern="dd/MM/yyyy"
               dataPatternLabel="gg/mm/aaaa" rendered="#{fglInterventoBean.erogazioneInterventoBean.situazioneEconomicaVerificata}" />
               
         </h:panelGrid>

		<webredcs:pnlProtocolloDsu iProtocolloDsu="#{fglInterventoBean.erogazioneInterventoBean.protDsuMan}" 
		                        disabled="#{fglInterventoBean.erogazioneInterventoBean.dataDsuDisabled}"
		                        visibile="#{fglInterventoBean.erogazioneInterventoBean.situazioneEconomicaVerificata}"
		                        numColumns="2"/>
			
         <p:commandButton id="cambiaDatiIseeBtn" value="Cambia"
            rendered="#{fglInterventoBean.erogazioneInterventoBean.dentroFascicolo and fglInterventoBean.erogazioneInterventoBean.situazioneEconomicaVerificata}" 
            disabled="#{fglInterventoBean.erogazioneInterventoBean.cambiaDatiIseeBtnDisabled}" process="@this"
            action="#{fglInterventoBean.erogazioneInterventoBean.situazioneEconomicaVerificataListener}" />

      </p:fieldset>
   </h:panelGroup>


   <!-- fine MOD-RL -->

     <h:panelGrid style="display: inline-block; vertical-align: top;" columns="1">
      <p:outputLabel id="lblDescErogazione" for="txtDescErogazione" value="Descrizione Erogazione" />      <!-- required="true"  requiredMessage="Inserire la descrizione per l'erogazione in Testata" -->
      <p:inputTextarea rows="2" cols="50" id="txtDescErogazione" 
         
         disabled="#{!fglInterventoBean.erogazioneInterventoBean.erogazionePossibile or fglInterventoBean.erogazioneInterventoBean.testataDisabled}"
         value="#{fglInterventoBean.erogazioneInterventoBean.nuovoIntEsegMast.descInterventoEseg}" autoResize="false">
         <!-- <p:ajax event="change" listener="#{fglInterventoBean.onCheckIfErogazionePossibile}" update="@parent:growl2"/> -->
      </p:inputTextarea>

   </h:panelGrid>
   <h:panelGrid id="pnlSpeseTestata" columns="1" style="display: inline-block; vertical-align: top; width:60%"
      styleClass="#{'updateFlagAttivazioneChange updateOnListaErogazioniChange'}">

      <p:panel header="Spese" id="fldsetSpese" styleClass="#{'updateOnTariffaUnitariaChange updateOnUnitaMisuraChange updateOnAggiornaTotSpese'}"
         toggleable="true" collapsed="true">
         <p:selectBooleanButton onLabel="Calcola il totale spese, da dettaglio" offLabel="Imposta manualmente le spese totali"
            onIcon="ui-icon-calculator" offIcon="ui-icon-pencil" id="btnCalcolaSpese"
            value="#{fglInterventoBean.erogazioneInterventoBean.calcolaSpesaDaDettaglio}"
            disabled="#{!fglInterventoBean.abilitaCheckCalcolo}">
            <p:ajax event="change" listener="#{fglInterventoBean.erogazioneInterventoBean.onChangeCalcolaSpeseTotali}"
               update="pnlQuotaTariffa, pnltestaPercValue, :#{p:component('fldsetCompartecipazioni')}, @parent:@parent:pnlDettaglio:panelAttributiErogazione" process="@this" />
         </p:selectBooleanButton>
         <h:panelGrid columns="4" id="pnlQuotaTariffa" rendered="false">
            <!--  rendered="#{!fglInterventoBean.erogazioneInterventoBean.calcolaSpesaDaDettaglio and fglInterventoBean.erogazioneInterventoBean.erogazionePossibile and fglInterventoBean.datiTariffeInterventoBean.csIQuota.csTbUnitaMisura.valore!=null and fglInterventoBean.datiTariffeInterventoBean.csIQuota.tariffa>0}" > -->
            <p:outputLabel value="Quota (#{fglInterventoBean.datiTariffeInterventoBean.csIQuota.csTbUnitaMisura.valore}): " />
            <p:inputText style="width:90px;" value="#{fglInterventoBean.erogazioneInterventoBean.valQuotaTestata}"
               converterMessage="Inserire valore numerico intero o decimale (es.12.34)">
               <p:ajax event="blur" process="@this" update="testa_txtSpesa"
                  listener="#{fglInterventoBean.erogazioneInterventoBean.onQuotaTestataUpdate(fglInterventoBean.datiTariffeInterventoBean.csIQuota.tariffa)}"/>
            </p:inputText>

            <p:outputLabel value="Motivo/Note: " />
            <p:inputText style="text-transform: uppercase; width:200px;"
               value="#{fglInterventoBean.erogazioneInterventoBean.motivazioneQuotaTestata}" maxlength="4000"/>
         </h:panelGrid>

         <h:panelGrid id="pnltestaPercValue" columns="5" width="100%">

            <p:outputLabel id="testa_lblSpesa" for="testa_txtSpesa" value="Importo prestazione €" /> <!-- Spesa -->
            <p:inputText id="testa_txtSpesa" style="width:90px;"
               disabled="#{fglInterventoBean.erogazioneInterventoBean.calcolaSpesaDaDettaglio or !fglInterventoBean.erogazioneInterventoBean.erogazionePossibile or fglInterventoBean.erogazioneInterventoBean.testataDisabled or (fglInterventoBean.datiTariffeInterventoBean.csIQuota.csTbUnitaMisura.valore!=null and fglInterventoBean.datiTariffeInterventoBean.csIQuota.tariffa>0 and fglInterventoBean.datiTariffeInterventoBean.csIQuota.csTbUnitaMisura.valore!='€')}"
               value="#{fglInterventoBean.erogazioneInterventoBean.nuovoIntEsegMast.spesa}"
               converterMessage="Il campo Spesa in testata non è corretto:inserire valore numerico intero o decimale (es.12.34)">
            </p:inputText>
            <p:tooltip id="tlt_testa_txtSpesa" for="testa_txtSpesa, testa_lblSpesa" value="Ex: 1999.99" trackMouse="true" />

            <p:outputLabel value="Quota a carico dell'ente" /> <!-- Spesa Gestita Direttamente -->
            <p:outputPanel>
               <p:selectOneRadio id="testa_rdSpesa" required="true" layout="custom"
                  disabled="#{fglInterventoBean.erogazioneInterventoBean.calcolaSpesaDaDettaglio or !fglInterventoBean.erogazioneInterventoBean.erogazionePossibile or fglInterventoBean.erogazioneInterventoBean.testataDisabled}"
                  value="#{fglInterventoBean.erogazioneInterventoBean.testaPercOrValue}">
                  <f:selectItem itemLabel="testaPercentuale" itemValue="testaPercentuale" />
                  <f:selectItem itemLabel="testaValore" itemValue="testaValore" />
                  <p:ajax update="testa_txtSpesaPerc,testa_txtSpesaVal"
                     listener="#{fglInterventoBean.erogazioneInterventoBean.setTestaPercValue}"/>
               </p:selectOneRadio>

               <h:panelGrid columns="4" cellpadding="1">
                  <p:radioButton id="testa_rdbnt_percen" for="testa_rdSpesa" itemIndex="0"
                     disabled="#{fglInterventoBean.erogazioneInterventoBean.calcolaSpesaDaDettaglio or !fglInterventoBean.erogazioneInterventoBean.erogazionePossibile or fglInterventoBean.erogazioneInterventoBean.testataDisabled}"/>
                  <p:outputLabel id="lbl_testa_rdbnt_percen" for="testa_rdbnt_percen" value="%" />
                  <p:inputText id="testa_txtSpesaPerc" style="width:90px;" maxlength="5"
                     disabled="#{!fglInterventoBean.erogazioneInterventoBean.isSpesaPercTesta or fglInterventoBean.erogazioneInterventoBean.calcolaSpesaDaDettaglio or  !fglInterventoBean.erogazioneInterventoBean.erogazionePossibile or fglInterventoBean.erogazioneInterventoBean.testataDisabled}"
                     value="#{fglInterventoBean.erogazioneInterventoBean.nuovoIntEsegMast.percGestitaEnte}"
                     converterMessage="% Quota a carico dell'ente in testata non corretta: inserire un valore intero tra 0 e 100"
                     validatorMessage="% Quota a carico dell'ente in testata non corretta: inserire un valore intero tra 0 e 100">
                     <f:validateDoubleRange minimum="0" maximum="100" />
                  </p:inputText>
                  <p:tooltip for="testa_txtSpesaPerc,lbl_testa_rdbnt_percen" value="Numero intero tra 0 e 100" trackMouse="true" />

                  <p:radioButton id="testa_rdbnt_valore" for="testa_rdSpesa" itemIndex="1"
                     disabled="#{fglInterventoBean.erogazioneInterventoBean.calcolaSpesaDaDettaglio or !fglInterventoBean.erogazioneInterventoBean.erogazionePossibile or fglInterventoBean.erogazioneInterventoBean.testataDisabled}"/>
                  <h:outputLabel id="lbl_testa_rdbnt_valore" for="testa_rdbnt_valore" value="Valore €" />
                  <p:inputText id="testa_txtSpesaVal" style="width:90px;"
                     disabled="#{!fglInterventoBean.erogazioneInterventoBean.isSpesaValTesta or fglInterventoBean.erogazioneInterventoBean.calcolaSpesaDaDettaglio or !fglInterventoBean.erogazioneInterventoBean.erogazionePossibile or fglInterventoBean.erogazioneInterventoBean.testataDisabled}"
                     value="#{fglInterventoBean.erogazioneInterventoBean.nuovoIntEsegMast.valoreGestitaEnte}"
                     converterMessage="Il campo Valore € non è corretto: Inserire valore numerico intero o decimale (es.12.34)">
                  </p:inputText>
                  <p:tooltip for="testa_txtSpesaVal, lbl_testa_rdbnt_valore" value="Ex: 1999.99" trackMouse="true" />
               </h:panelGrid>

            </p:outputPanel>

         </h:panelGrid>
      </p:panel>
      <p:panel id="fldsetCompartecipazioni" header="Compartecipazioni alla spesa" toggleable="true" collapsed="true"
         styleClass="updateOnUnitaMisuraChange updateOnAggiornaTotCompartecipazioni">
         <p:selectBooleanButton onLabel="Calcola il totale delle compartecipazioni, da dettaglio"
            offLabel="Imposta manualmente i valori totali delle compartecipazioni" onIcon="ui-icon-calculator" offIcon="ui-icon-pencil"
            id="btnCalcolaCompartecipazioni" value="#{fglInterventoBean.erogazioneInterventoBean.calcolaCompartDaDettaglio}"
            disabled="#{!fglInterventoBean.abilitaCheckCalcolo or fglInterventoBean.erogazioneInterventoBean.calcolaSpesaDaDettaglio}">
            <p:ajax event="change" update="pnlTestaCompartecipazione,  @parent:@parent:pnlDettaglio:panelAttributiErogazione" process="@this"
               listener="#{fglInterventoBean.erogazioneInterventoBean.onChangeCalcolaCompartecipazioniTot}"/>
         </p:selectBooleanButton>
         <h:panelGrid columns="8" id="pnlTestaCompartecipazione" width="100%">
            <p:outputLabel id="testa_lblCompartUtenti" for="testa_txtCompartUtenti" value="Comp.utenti"
               style="display: block; width: 120px;"/>
            <p:outputLabel value="€" />
            <p:inputText id="testa_txtCompartUtenti" style="width:90px;"
               disabled="#{fglInterventoBean.erogazioneInterventoBean.calcolaCompartDaDettaglio or !fglInterventoBean.erogazioneInterventoBean.erogazionePossibile or fglInterventoBean.erogazioneInterventoBean.testataDisabled}"
               value="#{fglInterventoBean.erogazioneInterventoBean.nuovoIntEsegMast.compartUtenti}"/>
            <p:tooltip for="testa_lblCompartUtenti, testa_txtCompartUtenti" value="Ex: 1999.99" trackMouse="true" />

            <p:outputLabel id="testa_lblCompartSSN" for="testa_txtCompartSSN" value="Comp. SSN" style="display: block; width: 120px;" />
            <p:outputLabel value="€" />
            <p:inputText id="testa_txtCompartSSN" style="width:90px;"
               disabled="#{fglInterventoBean.erogazioneInterventoBean.calcolaCompartDaDettaglio or !fglInterventoBean.erogazioneInterventoBean.erogazionePossibile or fglInterventoBean.erogazioneInterventoBean.testataDisabled}"
               value="#{fglInterventoBean.erogazioneInterventoBean.nuovoIntEsegMast.compartSsn}" />
            <p:tooltip for="testa_txtCompartSSN, testa_lblCompartSSN" value="Ex: 1999.99" trackMouse="true" />

            <p:outputLabel id="testa_lblAltreCompart" for="testa_txtAltreCompart" value="Altre comp."
               style="display: block; width: 120px;"/>
            <p:outputLabel value="€" />
            <p:inputText id="testa_txtAltreCompart" style="width:90px;"
               disabled="#{fglInterventoBean.erogazioneInterventoBean.calcolaCompartDaDettaglio or !fglInterventoBean.erogazioneInterventoBean.erogazionePossibile or fglInterventoBean.erogazioneInterventoBean.testataDisabled}"
               value="#{fglInterventoBean.erogazioneInterventoBean.nuovoIntEsegMast.compartAltre}"/>
            <p:tooltip for="testa_txtAltreCompart, testa_lblAltreCompart" value="Ex: 1999.99" trackMouse="true" />

            <p:outputLabel id="testa_lblNoteCompart" for="testa_txtNoteCompart" value="Note su altre comp."
               style="display: block; width: 120px;"/>
            <p:spacer width="5px" />
            <p:inputTextarea id="testa_txtNoteCompart" rows="2" cols="35"
               disabled="#{fglInterventoBean.erogazioneInterventoBean.calcolaCompartDaDettaglio or !fglInterventoBean.erogazioneInterventoBean.erogazionePossibile or fglInterventoBean.erogazioneInterventoBean.testataDisabled}"
               value="#{fglInterventoBean.erogazioneInterventoBean.nuovoIntEsegMast.noteAltreCompart}" autoResize="false"/>

         </h:panelGrid>
      </p:panel>

   </h:panelGrid>

</p:panel>

<h:panelGroup id="pnlGroupDettaglio" styleClass="#{'updateOnListaErogazioniChange'}">
   <!-- SISO-556 il pannello dettaglio è visibile solo se non ci sono righe erogazioni di chiusura -->
   <p:panel id="pnlDettaglio" header="Dettaglio" toggleable="true"
      rendered="#{fglInterventoBean.erogazioneInterventoBean.pnlDettaglioErogazioniRendered}"
      styleClass="#{'tabDettaglioWhite updateOnFrequenzaDelServizioChange updateFlagAttivazioneChange updateOnTipoBeneficiarioChange'}">
      <!-- SISO-556 gli stati variano in funzione della frequenza del servizio -->
      <h:panelGrid columns="4" style="display: inline-block; vertical-align: top;">
         <p:outputLabel value="Operazione" for="listaStatiErogValue" />
         <p:selectOneMenu id="listaStatiErogValue" disabled="#{!fglInterventoBean.erogazioneInterventoBean.erogazionePossibile}"
            value="#{fglInterventoBean.erogazioneInterventoBean.statoSelezionatoId}" process="@this" filter="true" filterMatchMode="contains" style="width:200px">
            <p:ajax listener="#{fglInterventoBean.onStatoChanged}" process="@this" update="@(.updateOnTipoOperazioneChange)"/>
            <f:selectItem noSelectionOption="true" itemLabel="- seleziona -" />
            <f:selectItems value="#{fglInterventoBean.erogazioneInterventoBean.getLstSelItemStatiErog(fglInterventoBean.datiTariffeInterventoBean.frequenzaAccessoAlServizio)}"/>
         </p:selectOneMenu>

         <!--  SISO-556 aggiunto metodo visualizzaIntervalloDateErogazione nel bean -->
         <h:panelGroup id="pnlLblDateErog"
            styleClass="#{'updateOnFlagPeriodoRipartizChange updateOnFrequenzaDelServizioChange updateOnFlagRendicontoChange updateOnTipoOperazioneChange'}">
            <p:outputLabel id="lblData" for="dataErogValue" value="Data" />
            <p:outputLabel id="lblDataDa" value=" da " rendered="#{fglInterventoBean.visualizzaIntervalloDateErogazione}" />
         </h:panelGroup>
         <h:panelGroup id="pnlDateErog"
            styleClass="#{'updateOnFlagPeriodoRipartizChange updateOnFrequenzaDelServizioChange updateOnFlagRendicontoChange updateOnTipoOperazioneChange'}">
            <webred:pnlData id="dataErogValue" dataReq="true" dataValue="#{fglInterventoBean.erogazioneInterventoBean.dataErog}"
               disabled="#{!fglInterventoBean.erogazioneInterventoBean.erogazionePossibile}"
               mindate="#{fglInterventoBean.datiFglIntBean.dtTipoAttDa}" maxdate="#{fglInterventoBean.datiFglIntBean.dtTipoAttA}"
               dataPattern="dd/MM/yyyy" dataPatternLabel="gg/mm/aaaa"/>
            <p:spacer width="10px" />
			<p:outputLabel id="lblDataA" for="dataErogAValue" value=" a "  rendered="#{fglInterventoBean.visualizzaIntervalloDateErogazione}" />
            <webred:pnlData id="dataErogAValue" rendered="#{fglInterventoBean.visualizzaIntervalloDateErogazione}"
               dataValue="#{fglInterventoBean.erogazioneInterventoBean.dataErogA}"
               disabled="#{!fglInterventoBean.erogazioneInterventoBean.erogazionePossibile}"
               required="#{fglInterventoBean.visualizzaIntervalloDateErogazione}"
               mindate="#{fglInterventoBean.datiFglIntBean.dtTipoAttDa}" maxdate="#{fglInterventoBean.datiFglIntBean.dtTipoAttA}"
               dataPattern="dd/MM/yyyy" dataPatternLabel="gg/mm/aaaa"/>
         </h:panelGroup>
      </h:panelGrid>

      <h:panelGrid id="pnlOperatoreScegliOrInserisci" columns="1" style="display: inline-block; vertical-align: top;">

         <p:outputPanel style="margin-bottom:10px">
            <p:selectOneRadio id="rdOpErogante" layout="custom"
               value="#{fglInterventoBean.erogazioneInterventoBean.operatoreScegliOrInserisci}"
               disabled="#{!fglInterventoBean.erogazioneInterventoBean.erogazionePossibile}" >
               <f:selectItem itemLabel="scegli" itemValue="scegli" />
               <f:selectItem itemLabel="inserisci" itemValue="inserisci" />
               <f:ajax render="pnlOperatoreScegliOrInserisci" listener="#{fglInterventoBean.erogazioneInterventoBean.setOperErogInputs}"/>
            </p:selectOneRadio>

            <h:panelGrid columns="4">
               <p:radioButton id="rdbnt_scegli" for="rdOpErogante" itemIndex="0" />

               <h:outputLabel id="lbl_cbxOperatoreOrgErog" for="rdbnt_scegli" value="Scegli Operatore" />
               <p:selectOneMenu id="cbxOperatoreOrgErog" style="width:120px"
                  value="#{fglInterventoBean.erogazioneInterventoBean.operatoreErogId}"
                  disabled="#{fglInterventoBean.erogazioneInterventoBean.operatoreScegliOrInserisci=='inserisci' or !fglInterventoBean.erogazioneInterventoBean.erogazionePossibile}">
                  <f:selectItem itemLabel="- seleziona -" noSelectionOption="true" />
                  <f:selectItems var="opAn" itemLabel="#{opAn.cognome} #{opAn.nome}" itemValue="#{opAn.id}"
                     value="#{fglInterventoBean.erogazioneInterventoBean.listaOperAnagrafica}"/>
               </p:selectOneMenu>
               <p:tooltip for="lbl_cbxOperatoreOrgErog, cbxOperatoreOrgErog" value="(chi ha effettuato il servizio/intervento)" trackMouse="true" />

               <p:radioButton id="rdbnt_inserisci" for="rdOpErogante" itemIndex="1"
                  disabled="#{!fglInterventoBean.erogazioneInterventoBean.erogazionePossibile}" />

               <h:outputLabel id="lbl_txtOperatoreOrgErog" for="txtOperatoreOrgErog" value="Inserisci altro operatore" />
               <p:inputText id="txtOperatoreOrgErog"
                  value="#{fglInterventoBean.erogazioneInterventoBean.nuovocsIntEseg.nomeOperatoreErog}"
                  disabled="#{!fglInterventoBean.erogazioneInterventoBean.erogazionePossibile}"/>
               <p:tooltip for="lbl_txtOperatoreOrgErog, txtOperatoreOrgErog" value="(chi ha effettuato il servizio/intervento)" trackMouse="true"/>
            </h:panelGrid>
         </p:outputPanel>

      </h:panelGrid>

      <h:panelGrid columns="2" style="display: inline-block; vertical-align: top;">
         <p:outputLabel id="lblNote" for="txtNote" value="Note" />
         <p:inputTextarea rows="1" cols="70" id="txtNote" autoResize="false"
            disabled="#{!fglInterventoBean.erogazioneInterventoBean.erogazionePossibile}"
            value="#{fglInterventoBean.erogazioneInterventoBean.nuovocsIntEseg.note}"/>
      </h:panelGrid>


      <p:outputPanel id="panelAttributiErogazione" style="width:100%" styleClass="#{'updateOnTipoOperazioneChange'}"> 

	      <h:panelGrid id="panelAttributi" columns="1" style="border:1px;">
	             <p:dataTable id="dataTableAttributi" var="erog" rowIndexVar="rowIndex"
	            rendered="#{!empty fglInterventoBean.erogazioneInterventoBean.erogaziones}"
	            value="#{fglInterventoBean.erogazioneInterventoBean.erogaziones}" styleClass="iterAttrTableStyleClass"
	            tableStyleClass="noStyleTable" rowStyleClass="noStyleTable" style="display: inline-block; vertical-align: top;">
	            <f:facet name="header">
			         		Attributi configurati per  
			       <h:outputLabel value="#{fglInterventoBean.erogazioneInterventoBean.nomeTipoErogazione}"
	                  rendered="#{fglInterventoBean.erogazioneInterventoBean.nomeTipoCustEroga eq NULL}"/>
	               <h:outputLabel value="#{fglInterventoBean.erogazioneInterventoBean.nomeTipoCustEroga}"
	                  rendered="#{fglInterventoBean.erogazioneInterventoBean.nomeTipoCustEroga ne NULL}"/>
	            </f:facet>
	
	            <p:column headerText="">
	               <h:outputText id="label" value="#{erog.label}" rendered="#{erog.abilitato}" />
	            </p:column>
	            <p:column headerText="">
	               <p:outputPanel rendered="#{erog.abilitato}">
	                  <p:inputMask value="#{erog.value}" mask="99:99" rendered="#{erog.time}" />
	                  <p:spinner value="#{erog.value}" rendered="#{erog.integer}" min="0" />
	                  <p:spinner value="#{erog.value}" rendered="#{erog.double}" min="0" stepFactor="0.01" />
	                  <p:inputText value="#{erog.value}" rendered="#{erog.string}" />
	                  <p:selectBooleanCheckbox value="#{erog.value}" rendered="#{erog.bool}" />
	                  <p:calendar value="#{erog.value}" pattern="dd/MM/yyyy" rendered="#{erog.date}" />
	
	                  <p:selectOneMenu value="#{erog.value}" rendered="#{erog.list}">
	                     <f:selectItem itemLabel="- seleziona - " itemValue="" noSelectionOption="true" />
	                     <f:selectItems value="#{erog.cmbxValues}" />
	                  </p:selectOneMenu>
	               </p:outputPanel>
	            </p:column>
	            <p:column headerText="">
	               <p:outputPanel rendered="#{erog.abilitato}">
	                  <h:outputText value="#{erog.unitaMisura}" rendered="#{erog.singleUnitaMisura}" />
	                  <p:selectOneMenu value="#{erog.selectedUnitaMisura}" rendered="#{erog.multipleUnitaMisura}" required="true"
	                     requiredMessage="#{erog.requiredMessage}">
	                     <f:selectItem itemLabel="- seleziona -" itemValue="" noSelectionOption="true" />
	                     <f:selectItems value="#{erog.cmbxUmeasure}" var="umeasure" itemLabel="#{umeasure.valore}"
	                        itemValue="#{umeasure.id}"/>
	                  </p:selectOneMenu>
	               </p:outputPanel>
	            </p:column>
	            <p:column headerText="">
	               <p:outputPanel rendered="#{erog.abilitato}">
	                  <p:graphicImage id="infoImage" value="/images/info.png" style="cursor:pointer" width="16" title="Info Attributo"
	                     rendered="#{erog.hasDescription}"/>
	                  <p:tooltip for="@(.iterAttrTableStyleClass tr[role=row][data-ri=#{rowIndex}])" showEffect="fade" hideEffect="fade"
	                     atPosition="top center" myPosition="bottom center" showDelay="500" rendered="#{erog.hasDescription}">
	                     <h:outputLabel value="#{erog.tooltip}" escape="false" />
	                  </p:tooltip>
	               </p:outputPanel>
	            </p:column>
	         </p:dataTable>
	      
	      <p:fieldset id="fldsetAttributi" style="background: #ffffff" legend="Importi prestazione" 
	      			  rendered="#{fglInterventoBean.erogazioneInterventoBean.visualizzaAttributi and (fglInterventoBean.erogazioneInterventoBean.calcolaSpesaDaDettaglio or fglInterventoBean.erogazioneInterventoBean.calcolaCompartDaDettaglio)}">
	        <p:wizard backLabel="indietro" nextLabel="avanti" widgetVar="wizSpese" id="wizardSpese" flowListener="#{fglInterventoBean.flowSpese}"  
	        		  rendered="#{fglInterventoBean.erogazioneInterventoBean.visualizzaAttributi and (fglInterventoBean.erogazioneInterventoBean.calcolaSpesaDaDettaglio or fglInterventoBean.erogazioneInterventoBean.calcolaCompartDaDettaglio)}">
	            <p:tab id="detta_tbSpese" title="Spese">
	              <p:fieldset id="fldsetTbSpese">
	               <webredcs:tooltipInfo title="Spese" stringDescr="#{fglInterventoBean.erogazioneInterventoBean.tooltipText.spese}" />
	               <p:outputPanel id="pnlQuotaDettaglio" styleClass="#{'updateOnTariffaUnitariaChange updateOnUnitaMisuraChange'}">
	                  <!-- SISO-556 spostata la logica di renderizzazione nel bean -->
	                  <h:panelGrid id="panelValQuota" columns="4" rendered="#{fglInterventoBean.visualizzaPanelValQuota}" cellspacing="3">
	                     <p:outputLabel
	                        value="#{fglInterventoBean.datiTariffeInterventoBean.csIQuota.csTbUnitaMisura.valore!=null ? fglInterventoBean.datiTariffeInterventoBean.csIQuota.csTbUnitaMisura.valore : '- seleziona unità di misura -' }"/>
	                     <p:inputText id="qntUnitaMisura" style="width:90px;"  rendered="#{!fglInterventoBean.datiTariffeInterventoBean.csIQuota.oreMinuti}"
	                        value="#{fglInterventoBean.erogazioneInterventoBean.nuovocsIntEseg.csIValQuota.valQuota}"
	                        disabled="#{!fglInterventoBean.erogazioneInterventoBean.calcolaSpesaDaDettaglio}"
	                        converterMessage="Inserire valore numerico intero o decimale (es.12.34)">
	 					 </p:inputText>	
	      				 <p:outputPanel id="pnlOreMinuti"  rendered="#{fglInterventoBean.datiTariffeInterventoBean.csIQuota.oreMinuti}">
		 					 <p:inputText id="qntOre"  style="width:25px;" value="#{fglInterventoBean.erogazioneInterventoBean.oreErogazione}" maxlength="2"
		 					    converterMessage="Il campo Ore non è corretto:inserire valore numerico intero"  >
		                      </p:inputText>	:
		 					  <p:inputText id="qntMinuti"    value="#{fglInterventoBean.erogazioneInterventoBean.minutiErogazione}"
		                         style="width:25px;" maxlength="2"
		                         converterMessage="Il campo Minuti non è corretto:inserire valore numerico intero compreso tra 0 e 59"> 
		                      </p:inputText>
	 					 </p:outputPanel>
	 					 
	                     <!-- SISO-1132 valore modificato in "Tariffa €: " -->
	                     <p:outputLabel value="Tariffa €: " />
						 <p:inputText id="inputTariffaUnitariaPerSpesa" style="width: 50px;"
									value="#{fglInterventoBean.erogazioneInterventoBean.tariffaLocale}"
									styleClass="#{'updateOnUnitaMisuraChange updateFlagAttivazioneChange updateOnListaErogazioniChange updateOnTariffaUnitariaChange'}"
									disabled="#{fglInterventoBean.tariffaDisabled}">
								<!-- SISO-1132 aggiunto attributo "disabled" -->			
	                     </p:inputText>	
	                     <p:outputLabel value="Motivo/Note: " />
	                     <p:inputText style="text-transform: uppercase; width:200px;"
	                        value="#{fglInterventoBean.erogazioneInterventoBean.nuovocsIntEseg.csIValQuota.note}" maxlength="4000"/>
	                  </h:panelGrid>
	                  
	               </p:outputPanel>
	               
	               </p:fieldset>
	            </p:tab>
	            <p:tab id="detta_tbCompart" title="Compartecipazioni alla spesa" rendered="#{fglInterventoBean.erogazioneInterventoBean.calcolaCompartDaDettaglio}">
	            <p:fieldset id="fldsetTbCompart" >
	                   <h:panelGrid columns="4">
	                  <webredcs:tooltipInfo title="Compartecipazioni" stringDescr="#{fglInterventoBean.erogazioneInterventoBean.tooltipText.compartecipazioni}" />
	                   <p:outputLabel id="detta_lblSpesa" for="detta_txtSpesa" value="Importo prestazione" />
	                     <p:inputText id="detta_txtSpesa" style="width:90px;"
	                        disabled="#{fglInterventoBean.datiTariffeInterventoBean.csIQuota.csTbUnitaMisura.valore!=null and fglInterventoBean.datiTariffeInterventoBean.csIQuota.tariffa>0}"
	                        value="#{fglInterventoBean.erogazioneInterventoBean.nuovocsIntEseg.spesa}"
	                        converterMessage="Il campo Importo prestazione in dettaglio non è corretto:inserire valore numerico intero o decimale (es.12.34)">
	                     </p:inputText>
	                     <p:tooltip id="tlt_detta_txtSpesa" for="detta_txtSpesa, detta_lblSpesa, qntUnitaMisura" value="Ex: 1999.99"
	                        trackMouse="true"/>
	                  </h:panelGrid>
	                  <h:panelGrid columns="4" >
	                  <p:outputLabel id="detta_lblCompartUtenti" for="detta_txtCompartUtenti" value="Comp.utenti:"
	                     style="display: block; width: 120px;"/>
	                  <p:outputLabel value="€" />
		                  <p:inputText id="detta_txtCompartUtenti" style="width:90px;"
		                     value="#{fglInterventoBean.erogazioneInterventoBean.nuovocsIntEseg.compartUtenti}"
		                     converterMessage="Il campo Compartecipazione Utenti alla Spesa in dettaglio non è corretto:inserire valore numerico intero o decimale (es.12.34), minore della Spesa"
		                     validatorMessage="Il campo Compartecipazione Utenti alla Spesa in dettaglio non è corretto:inserire valore numerico intero o decimale (es.12.34), minore della Spesa">
		                     <f:validateDoubleRange minimum="0" />
		                  </p:inputText>
		                  <p:tooltip for="detta_lblCompartUtenti, detta_txtCompartUtenti" value="Ex: 1999.99" trackMouse="true" />
		
		                  <p:outputLabel id="detta_lblCompartSSN" for="detta_txtCompartSSN" value="Comp. SSN" style="display: block; width: 120px;"/>
		                  <p:outputLabel value="€" />
		                  <p:inputText id="detta_txtCompartSSN" style="width:90px;"
		                     value="#{fglInterventoBean.erogazioneInterventoBean.nuovocsIntEseg.compartSsn}"
		                     converterMessage="Il campo Compartecipazione SSN alla Spesa in dettaglio non è corretto:inserire valore numerico intero o decimale (es.12.34), minore della Spesa"
		                     validatorMessage="Il campo Compartecipazione SSN alla Spesa in dettaglio non è corretto:inserire valore numerico intero o decimale (es.12.34), minore della Spesa">
		                     <f:validateDoubleRange minimum="0" />
		                  </p:inputText>
		                  <p:tooltip for="detta_txtCompartSSN, detta_lblCompartSSN" value="Ex: 1999.99" trackMouse="true" />
	               </h:panelGrid>
	               <p:spacer height="20px" />
	                 <h:panelGrid columns="4" style="width:100%">
			               <p:commandButton value="Imposta tutto a zero" title="Imposta tutto a zero"
			                  icon="ui-icon-calculator" action="#{fglInterventoBean.erogazioneInterventoBean.onImpostaTuttoAZero}"
			                   process="@parent" update=":#{p:component('fldsetAttributi')}"/>
			                   
			                <p:commandButton value="Aggiorna totale compartecipazioni" title="Ricalcola i valori totali in testata"
			                  icon="ui-icon-calculator" action="#{fglInterventoBean.erogazioneInterventoBean.onChangeCalcolaCompartecipazioniTot}"
			                  process="wizardSpese" update="@(.updateOnAggiornaTotCompartecipazioni)" />
	                 
	                  </h:panelGrid>
				  </p:fieldset>
	            </p:tab>
	            <p:tab id="detta_tbCaricoEnte" title="In carico all'ente">
	             <p:fieldset id="fldsettbCaricoEnte">
	            <h:panelGrid id="pnldettaPercValue" columns="4">
	                   <p:outputLabel value="Quota a carico dell'Ente" />
	                     <p:outputPanel id="pnl_detta_spesa_opt">
	                       
	                           <p:outputLabel id="lbl_detta_rdbnt_percen"  value="%" />
	                           <p:inputText id="detta_txtSpesaPerc" style="width:90px;" maxlength="5"
	                              disabled="#{!fglInterventoBean.erogazioneInterventoBean.isSpesaValDetta}"
	                              value="#{fglInterventoBean.erogazioneInterventoBean.nuovocsIntEseg.percGestitaEnte}"
	                              converterMessage="% Quota a carico dell'ente in dettaglio non corretta: inserire un valore intero tra 0 e 100"
	                              validatorMessage="% Quota a carico dell'ente in dettaglio non corretta: inserire un valore intero tra 0 e 100">
	                              <f:validateDoubleRange minimum="0" maximum="100" />
	                           </p:inputText>
	                           <p:tooltip for="detta_txtSpesaPerc,lbl_detta_rdbnt_percen" value="Numero intero tra 0 e 100"
	                              trackMouse="true"/>
	
	                         <h:outputLabel id="lbl_detta_rdbnt_valore"  value="Valore €" />
	                           <p:inputText id="detta_txtSpesaVal" style="width:90px;"
	                              disabled="#{!fglInterventoBean.erogazioneInterventoBean.isSpesaValDetta}"
	                              value="#{fglInterventoBean.erogazioneInterventoBean.nuovocsIntEseg.valoreGestitaEnte}"
	                              converterMessage="Inserire valore numerico intero o decimale (es.12.34)" >
	                           </p:inputText>
	                           <p:tooltip for="detta_txtSpesaVal, lbl_detta_rdbnt_valore" value="Ex: 1999.99" trackMouse="true" />
	                          </p:outputPanel>
	                </h:panelGrid>     
	                   <p:spacer height="10px" />
	                   <h:panelGrid columns="4" style="width:100%">
			               <p:commandButton value="Aggiorna totale spese" title="Ricalcola i valori totali in testata" icon="ui-icon-calculator"
			               		rendered="#{fglInterventoBean.erogazioneInterventoBean.calcolaSpesaDaDettaglio}"
					            action="#{fglInterventoBean.erogazioneInterventoBean.onChangeValoriSpesaDettaglio}" process="wizardSpese"
					            update="@(.updateOnAggiornaTotSpese)"/>
					            
					         <p:commandButton id="btnConferma" value="Conferma" icon="ui-icon-disk"
					            actionListener="#{fglInterventoBean.aggiungiAttributiFglIntervento}" validateClient="false"
					         	process="@form" disabled="#{!fglInterventoBean.erogazioneInterventoBean.enabledAggiungi}"
	                       		update="@(.updateOnListaErogazioniChange)" />
	    			  </h:panelGrid>
	    			   </p:fieldset>
	            </p:tab>
	          </p:wizard>
	     </p:fieldset>

     </h:panelGrid>
      <h:panelGrid columnClasses="centered" columns="1">
         <p:spacer height="10px" />
         <p:commandButton id="btnAggiungiAttributi" value="Aggiungi"      
            rendered="#{!(fglInterventoBean.erogazioneInterventoBean.visualizzaAttributi and (fglInterventoBean.erogazioneInterventoBean.calcolaSpesaDaDettaglio or fglInterventoBean.erogazioneInterventoBean.calcolaCompartDaDettaglio))}"
            actionListener="#{fglInterventoBean.aggiungiAttributiFglIntervento}" validateClient="false"
            process="@form" 
            disabled="#{!fglInterventoBean.erogazioneInterventoBean.enabledAggiungi}"
            update="@(.updateOnListaErogazioniChange)"/>
      </h:panelGrid>
      
      </p:outputPanel>
   </p:panel>

</h:panelGroup>



<p:panel id="panelStorico" header="Storico operazioni" toggleable="true" styleClass="#{'updateOnListaErogazioniChange updateFlagAttivazioneChange'}">
   <p:dataTable id="dataTableStorico" var="row" value="#{fglInterventoBean.erogazioneInterventoBean.erogazioneHistory.rows}"
      emptyMessage="Nessuna erogazione presente" styleClass="iterAttrTableStyleClass" tableStyleClass="noStyleTable"
      rowStyleClass="noStyleTable"  scrollable="true">
      <p:column style="text-align:center;" width="10px">
         <p:graphicImage id="NuovoAttributo" value="#{resource['webredcs/img/add.png']}" width="10px" rendered="#{row.nuovaErogazione}"
            title="Nuova Erogazione da salvare" style="cursor:pointer"/>
      </p:column>

      <p:columns value="#{fglInterventoBean.erogazioneInterventoBean.erogazioneHistory.header.columns}" columnIndexVar="colIndex"
         var="col" footerText="#{fglInterventoBean.erogazioneInterventoBean.erogazioneHistory.totals[colIndex]}" headerText="#{col}">
         <h:outputText value="#{row.cells[colIndex].stringValue}" rendered="#{row.cells[colIndex].imageURL eq null}" />
         <webredcs:tooltipInfo stringDescr="#{row.cells[colIndex].stringValue}"
            rendered="#{row.cells[colIndex].imageURL ne null and row.cells[colIndex].stringValue ne '-'}"
            icona="#{resource[row.cells[colIndex].imageURL]}"/>
      </p:columns>

	  <p:column headerText="Ultima modifica" style="text-align:center;">
	         <h:panelGrid columns="1"  >
	 	   		<h:outputText id="userIns" value="#{row.utenteModifica}" />
	 	   		<h:outputText value="#{row.intEseg.dtIns}" >
	 	   			<f:convertDateTime pattern="dd/MM/yyyy" />
	 	   		</h:outputText>	
	 	   		<p:tooltip for="userIns" value="L'operatore che ha inserito è #{row.utenteModifica} in data #{row.intEseg.dtIns}"
	 	   				   showEffect="fade" hideEffect="explode"	rendered="#{row.intEseg.userIns != NULL}" />
	       </h:panelGrid>
	  </p:column>
	     <p:column style="text-align:center;" headerText="Info">
         <webredcs:tooltipInfo selectItemList="#{row.listaInformazioni}"  rendered="#{!empty row.listaInformazioni}"  icona="#{resource['webredcs/img/info.png']}" />
      </p:column>      
      <p:column style="text-align:center;">
         <p:commandLink ajax="true" rendered="#{fglInterventoBean.erogazioneInterventoBean.erogazionePossibile}"
            action="#{fglInterventoBean.erogazioneInterventoBean.rimuoviRigaStorico(row)}"
            update="@parent:@parent, @(.updateOnListaErogazioniChange)"
            process="@this" >
            <span title="Remove" class="ui-icon ui-icon-trash" />
            <p:confirm header="Confirmation" message="Confermi eliminazione?" icon="ui-icon-alert" />
         </p:commandLink>
         <p:confirmDialog global="true" showEffect="fade" hideEffect="explode">
            <p:commandButton value="SI" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
            <p:commandButton value="NO" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
         </p:confirmDialog>
      </p:column>
   </p:dataTable>
</p:panel>

</html>