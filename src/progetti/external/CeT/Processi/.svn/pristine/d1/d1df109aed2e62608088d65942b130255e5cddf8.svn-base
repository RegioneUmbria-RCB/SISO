tableA.name=RE_DEMOG_ANAGRAFE_2_1
file.prefix=ANA_PER_
#
Caricatore.class.noversion=it.webred.rulengine.brick.loadDwh.load.demografia.anagrafeExt.v1.ImportDemogAnagrafeExt
#
#------------------------
# Tracciato record v 1.0
#------------------------
nof.fields=69
#indice inizio incluso, lunghezza (come substring java)
field.1.range=0:1
field.2.range=1:100
field.3.range=101:16
field.4.range=117:1
field.5.range=118:8
field.6.range=126:1
field.7.range=127:7
field.8.range=134:50
field.9.range=184:4
field.10.range=188:3
field.11.range=191:8
field.12.range=199:3
field.13.range=202:4
field.14.range=206:50
field.15.range=256:6
field.16.range=262:5
field.17.range=267:5
field.18.range=272:5
field.19.range=277:5
field.20.range=282:5
field.21.range=287:8
field.22.range=295:7
field.23.range=302:50
field.24.range=352:4
field.25.range=356:3
field.26.range=359:50
field.27.range=409:50
field.28.range=459:10
field.29.range=469:25
field.30.range=494:10
field.31.range=504:25
field.32.range=529:3
field.33.range=532:10
field.34.range=542:8
field.35.range=550:3
field.36.range=553:4
field.37.range=557:6
field.38.range=563:3
field.39.range=566:8
field.40.range=574:10
field.41.range=584:10
field.42.range=594:8
field.43.range=602:8
field.44.range=610:7
field.45.range=617:50
field.46.range=667:4
field.47.range=671:3
field.48.range=674:50
field.49.range=724:3
field.50.range=727:3
field.51.range=730:50
field.52.range=780:1
field.53.range=781:8
field.54.range=789:8
field.55.range=797:8
field.56.range=805:8
field.57.range=813:5
field.58.range=818:10
field.59.range=828:8
field.60.range=836:8
field.61.range=844:1
field.62.range=845:50
field.63.range=895:10
field.64.range=905:1
field.65.range=906:16
field.66.range=922:50
field.67.range=972:50
field.68.range=1022:8
field.69.range=1030:2
#------------------------
# Query controllo viario
#------------------------
ctrlViario.nome.1=DESC_DIVERSA
ctrlViario.intestazione.1=VIE CON CODICE COINCIDENTE MA DESCRIZIONE DIVERSA
ctrlViario.sql.1=SELECT DISTINCT \
NVL((SELECT MAX('SI') FROM RE_DEMOG_ANAGRAFE_2_1 AA WHERE AA.CODICE_VIA \= A.CODICE_VIA AND (AA.FLAG_STATO \='A' OR AA.CODICE_EVENTO IS NOT NULL)),'NO') COMUNE_VIA_ATTIVA, \
CM_CFIS, CM_DESC, LPAD(LTRIM(V.CODICE_VIA, '0'), LENGTH(ST_STRADA), '0') COMUNE_CODICE_VIA, DECODE(V.SEDIME || ' ' || V.DESCRIZIONE, ' ', '*** DESCRIZIONE NON FORNITA NEL FLUSSO COMUNALE ***', V.SEDIME || ' ' || V.DESCRIZIONE) COMUNE_DESC_VIA, ST_STRADA ANASAN_CODICE_STRADA, ST_TIPO ANASAN_TIPO_STRADA, S.ST_INDIR ANASAN_DESC_VIA \
FROM RE_DEMOG_ANAGRAFE_2_1 A LEFT JOIN RE_DEMOG_VIE_1_0 V \
ON A.CODICE_VIA \= V.CODICE_VIA \
INNER JOIN V_ANASAN_STRADE S \
ON LPAD(A.CODICE_VIA,10,'0') \= LPAD(ST_STRADA,10,'0') \
AND LTRIM(RTRIM(V.SEDIME || ' ' || V.DESCRIZIONE)) <> LTRIM(RTRIM(ST_INDIR)) \
ORDER BY COMUNE_CODICE_VIA
ctrlViario.nome.2=COD_DIVERSO
ctrlViario.intestazione.2=VIE CON DESCRIZIONE UGUALE, CODICE DIVERSO
ctrlViario.sql.2=SELECT DISTINCT \
NVL((SELECT MAX('SI') FROM RE_DEMOG_ANAGRAFE_2_1 AA WHERE AA.CODICE_VIA \= A.CODICE_VIA AND (AA.FLAG_STATO \='A' OR AA.CODICE_EVENTO IS NOT NULL)),'NO') COMUNE_VIA_ATTIVA, \
CM_CFIS, CM_DESC, LPAD(LTRIM(V.CODICE_VIA, '0'), LENGTH(ST_STRADA), '0') COMUNE_CODICE_VIA, DECODE(V.SEDIME || ' ' || V.DESCRIZIONE, ' ', '*** DESCRIZIONE NON FORNITA NEL FLUSSO COMUNALE ***', V.SEDIME || ' ' || V.DESCRIZIONE) COMUNE_DESC_VIA, ST_STRADA ANASAN_CODICE_STRADA, ST_TIPO ANASAN_TIPO_STRADA, S.ST_INDIR ANASAN_DESC_VIA \
FROM RE_DEMOG_ANAGRAFE_2_1 A LEFT JOIN RE_DEMOG_VIE_1_0 V \
ON A.CODICE_VIA \= V.CODICE_VIA \
INNER JOIN V_ANASAN_STRADE S \
ON LPAD(A.CODICE_VIA,10,'0') <> LPAD(ST_STRADA,10,'0') \
AND LTRIM(RTRIM(V.SEDIME || ' ' || V.DESCRIZIONE)) \= LTRIM(RTRIM(ST_INDIR)) \
ORDER BY COMUNE_CODICE_VIA
ctrlViario.nome.3=NO_ANASAN
ctrlViario.intestazione.3=VIE DEL COMUNE IL CUI CODICE NON ESISTE IN ANAGRAFE SANITARIA
ctrlViario.sql.3=SELECT DISTINCT \
NVL((SELECT MAX('SI') FROM RE_DEMOG_ANAGRAFE_2_1 AA WHERE AA.CODICE_VIA \= A.CODICE_VIA AND (AA.FLAG_STATO \='A' OR AA.CODICE_EVENTO IS NOT NULL)),'NO') COMUNE_VIA_ATTIVA, \
E.CODENT, E.DESCRIZIONE COMUNE_DESCR, LPAD(LTRIM(A.CODICE_VIA, '0'), CASE WHEN LENGTH(LTRIM(A.CODICE_VIA, '0')) > 5 THEN LENGTH(LTRIM(A.CODICE_VIA, '0')) ELSE 5 END, '0') COMUNE_CODICE_VIA, DECODE(V.SEDIME || ' ' || V.DESCRIZIONE, ' ', '*** DESCRIZIONE NON FORNITA NEL FLUSSO COMUNALE ***', V.SEDIME || ' ' || V.DESCRIZIONE) COMUNE_DESC_VIA \
FROM RE_DEMOG_ANAGRAFE_2_1 A LEFT JOIN RE_DEMOG_VIE_1_0 V \
ON A.CODICE_VIA \= V.CODICE_VIA, SIT_ENTE E \
WHERE NOT EXISTS \
(SELECT 1 FROM V_ANASAN_STRADE S \
WHERE LPAD(A.CODICE_VIA,10,'0') \= LPAD(ST_STRADA,10,'0') \
) \
ORDER BY COMUNE_CODICE_VIA
ctrlViario.nome.4=DESC_SIMILE
ctrlViario.intestazione.4=VIE CON CODICE DIVERSO MA DESCRIZIONE MOLTO SIMILE
ctrlViario.sql.4=SELECT * FROM ( \
SELECT DISTINCT \
NVL((SELECT MAX('SI') FROM RE_DEMOG_ANAGRAFE_2_1 AA WHERE AA.CODICE_VIA \= V.CODICE_VIA AND (AA.FLAG_STATO \='A' OR AA.CODICE_EVENTO IS NOT NULL)),'NO') COMUNE_VIA_ATTIVA, \
UTL_MATCH.EDIT_DISTANCE(V.SEDIME || ' ' || V.DESCRIZIONE, ST_INDIR) GAP_DESCRIZIONE_0_N, \
LPAD(LTRIM(CODICE_VIA, '0'), LENGTH(ST_STRADA), '0') COMUNE_CODICE_VIA, V.SEDIME || ' ' || V.DESCRIZIONE COMUNE_DESC_VIA, ST_STRADA ANASAN_CODICE_STRADA, ST_TIPO ANASAN_TIPO_STRADA, S.ST_INDIR ANASAN_DESC_VIA \
FROM RE_DEMOG_VIE_1_0 V, V_ANASAN_STRADE S \
WHERE LPAD(CODICE_VIA,10,'0') <> LPAD(ST_STRADA,10,'0') \
AND UTL_MATCH.EDIT_DISTANCE(V.SEDIME || ' ' || V.DESCRIZIONE, ST_INDIR ) <\= 3 \
AND NOT EXISTS \
( \
SELECT 1 FROM V_ANASAN_STRADE SS WHERE \
LTRIM(RTRIM(V.SEDIME || ' ' || V.DESCRIZIONE)) \= LTRIM(RTRIM(SS.ST_INDIR)) \
AND \
LPAD(CODICE_VIA,10,'0') \= LPAD(SS.ST_STRADA,10,'0') \
) \
) \
WHERE NOT EXISTS (SELECT 1 \
FROM RE_DEMOG_VIE_1_0 V1 \
WHERE LPAD(V1.CODICE_VIA,10,'0') \= LPAD(ANASAN_CODICE_STRADA,10,'0') \
) \
ORDER BY COMUNE_CODICE_VIA
